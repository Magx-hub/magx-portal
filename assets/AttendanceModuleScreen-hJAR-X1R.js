import{c as D,j as e,C,X as F,U as I,b as P}from"./index-Ce_HGe5B.js";import{r as x}from"./router-DwwGQyGz.js";import{g as E,a as B,b as _,c as q,d as U,e as V,u as G}from"./useTeachers-bX24J2AZ.js";import{S as Q,P as T}from"./search-enxbjVd2.js";import{D as X}from"./download-B26AevMF.js";import{q as Z,c as J,w,g as K}from"./firebase-Bm0Jh8Cr.js";import{d as Y}from"./config-CjFVmyQa.js";import{T as H}from"./trending-up-OZT0JddI.js";import"./vendor-c5ypKtDW.js";/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]],te=D("chart-pie",ee);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],ae=D("chevron-down",se);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],ne=D("clock",re),$=(t,s)=>{if(!t||!s)return 0;try{const[a,r]=t.split(":").map(Number),[n,m]=s.split(":").map(Number),o=a*60+r,i=n*60+m,l=i>=o?i-o:1440-o+i;return Math.round(l/60*100)/100}catch{return 0}},R=(t,s="08:00")=>{if(!t)return"Absent";try{const[a,r]=t.split(":").map(Number),[n,m]=s.split(":").map(Number),o=a*60+r,i=n*60+m;return o<=i?"Present":o<=i+30?"Late":"Very Late"}catch{return"Unknown"}},z=(t,s="2024-09-01")=>{try{const a=new Date(t),r=new Date(s),n=a.getTime()-r.getTime(),m=Math.ceil(n/(1e3*60*60*24)),o=Math.ceil(m/7);return Math.max(1,Math.min(16,o))}catch{return 1}},N=(t,s="text")=>{if(typeof t!="string")return"";let a=t.trim();switch(s){case"name":a=a.replace(/[^a-zA-Z\s'-]/g,"");break;case"time":if(!/^([01]?[0-9]|2[0-3]):[0-5][0-9]$/.test(a))return"";break;case"date":if(!/^\d{4}-\d{2}-\d{2}$/.test(a))return"";break;default:a=a.replace(/[<>"']/g,"")}return a},le=async({teacherId:t,date:s,checkInTime:a,checkOutTime:r,status:n,remarks:m})=>{const o=N(String(t||""),"text"),i=N(s||"","date"),l=N(a||"","time"),u=N(r||"","time"),g=n||R(l),y=z(i),p=$(l,u),b=await _(o),f={teacherId:o,fullname:b.fullname,date:i,weekNum:y,checkInTime:l||null,checkOutTime:u||null,workHours:Number.isFinite(p)?p:0,status:g,remarks:(m||"").trim()};return await q(f)},ce=async(t,s)=>{const a={...s.checkInTime!==void 0?{checkInTime:N(s.checkInTime||"","time")||null}:{},...s.checkOutTime!==void 0?{checkOutTime:N(s.checkOutTime||"","time")||null}:{},...s.status!==void 0?{status:s.status}:{},...s.remarks!==void 0?{remarks:(s.remarks||"").trim()}:{}};if(a.checkInTime!==void 0||a.checkOutTime!==void 0){const r=$(a.checkInTime,a.checkOutTime);a.workHours=Number.isFinite(r)?r:0,!a.status&&a.checkInTime&&(a.status=R(a.checkInTime))}return await U(t,a),!0},oe=async t=>{const s=N(t||"","date");return(await E(s)).map(M)},de=async(t,s,a)=>(await B(t,s,a)).map(M),ie=t=>{const s={totalRecords:t.length,presentCount:0,absentCount:0,lateCount:0,halfDayCount:0,avgWorkHours:0};let a=0;return t.forEach(r=>{r.status==="Present"&&(s.presentCount+=1),r.status==="Absent"&&(s.absentCount+=1),(r.status==="Late"||r.status==="Very Late")&&(s.lateCount+=1),r.status==="Half Day"&&(s.halfDayCount+=1),a+=r.workHours||0}),s.avgWorkHours=t.length>0?Number((a/t.length).toFixed(2)):0,s},ue=t=>{const s=new Map;for(const a of t){const r=a.teacherId||"unknown";s.has(r)||s.set(r,{fullname:a.fullname||"Unknown",department:a.department||"Unknown",daysTracked:0,presentDays:0,totalWorkHours:0,avgWorkHours:0});const n=s.get(r);n.daysTracked+=1,a.status==="Present"&&(n.presentDays+=1),n.totalWorkHours+=a.workHours||0}return s.forEach(a=>{a.avgWorkHours=a.daysTracked>0?Number((a.totalWorkHours/a.daysTracked).toFixed(2)):0}),Array.from(s.values()).sort((a,r)=>a.fullname.localeCompare(r.fullname))},M=t=>({id:t.id,teacherId:t.teacherId,fullname:t.fullname,department:t.department,date:t.date,weekNum:t.weekNum,checkInTime:t.checkInTime||null,checkOutTime:t.checkOutTime||null,workHours:t.workHours||0,status:t.status,remarks:t.remarks||""}),me=()=>{const[t,s]=x.useState([]),[a,r]=x.useState(!1),[n,m]=x.useState(null),[o,i]=x.useState({date:null,teacherId:null,startDate:null,endDate:null}),l=x.useCallback(async c=>{r(!0),m(null);try{const d=await oe(c);s(d)}catch(d){m(d.message||"Failed to load attendance")}finally{r(!1)}},[]),u=x.useCallback(async(c,d,h)=>{r(!0),m(null);try{const k=await de(c,d,h);s(k)}catch(k){m(k.message||"Failed to load attendance")}finally{r(!1)}},[]),g=x.useCallback(async(c,d)=>{r(!0),m(null);try{const h=await V(c,d);s(h)}catch(h){m(h.message||"Failed to load attendance")}finally{r(!1)}},[]),y=x.useCallback(async c=>{r(!0),m(null);try{const d=await le(c);return c.date&&await l(c.date),d}catch(d){throw m(d.message||"Failed to save attendance"),d}finally{r(!1)}},[l]),p=x.useCallback(async(c,d)=>{r(!0),m(null);try{await ce(c,d),o.date&&await l(o.date)}catch(h){throw m(h.message||"Failed to update attendance"),h}finally{r(!1)}},[o,l]),b=x.useMemo(()=>({daily:ie(t),weekly:ue(t)}),[t]),f=x.useCallback(c=>i(d=>({...d,...c})),[]),j=x.useCallback(c=>z(c),[]);return{records:t,loading:a,error:n,filters:o,loadByDate:l,loadByTeacherRange:u,loadByDateRange:g,saveRecord:y,updateRecord:p,updateFilters:f,stats:b,getWeekNumber:j}},xe=({activeView:t,setActiveView:s})=>e.jsxs("div",{className:"flex mt-3 bg-gray-100 rounded-lg p-1",children:[e.jsx("button",{onClick:()=>s("records"),className:`flex-1 py-2 px-3 rounded-md text-sm font-medium transition-colors ${t==="records"?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"Records"}),e.jsx("button",{onClick:()=>s("analytics"),className:`flex-1 py-2 px-3 rounded-md text-sm font-medium transition-colors ${t==="analytics"?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"Analytics"})]}),he=({date:t,setDate:s,search:a,setSearch:r,showFilters:n,setShowFilters:m})=>e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Filters"}),e.jsx("button",{onClick:()=>m(!n),className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(ae,{size:20,className:`transform transition-transform ${n?"rotate-180":""}`})})]}),e.jsxs("div",{className:`space-y-3 ${n?"":"hidden"}`,children:[e.jsxs("div",{className:"flex items-center bg-gray-50 border border-gray-200 rounded-lg px-3 py-2",children:[e.jsx(C,{size:18,className:"text-gray-500 mr-2"}),e.jsx("input",{type:"date",value:t,onChange:o=>s(o.target.value),className:"bg-transparent border-none outline-none w-full text-gray-900"})]}),e.jsxs("div",{className:"flex items-center bg-gray-50 border border-gray-200 rounded-lg px-3 py-2",children:[e.jsx(Q,{size:18,className:"text-gray-500 mr-2"}),e.jsx("input",{placeholder:"Search by name or department",value:a,onChange:o=>r(o.target.value),className:"bg-transparent border-none outline-none w-full text-gray-900 placeholder-gray-500"})]})]}),e.jsx("div",{className:`space-y-3 ${n?"hidden":""}`,children:e.jsx("div",{className:"grid grid-cols-1 gap-3",children:e.jsxs("div",{className:"flex items-center bg-gray-50 border border-gray-200 rounded-lg px-3 py-2",children:[e.jsx(C,{size:18,className:"text-gray-500 mr-2"}),e.jsx("input",{type:"date",value:t,onChange:o=>s(o.target.value),className:"bg-transparent border-none outline-none w-full text-gray-900"})]})})})]}),ge=({showAddForm:t,setShowAddForm:s,handleExport:a})=>e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Quick Actions"}),e.jsx("button",{onClick:()=>s(!t),className:`p-2 rounded-lg transition-colors ${t?"bg-red-100 text-red-600 hover:bg-red-200":"bg-blue-100 text-blue-600 hover:bg-blue-200"}`,children:t?e.jsx(F,{size:20}):e.jsx(T,{size:20})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[e.jsxs("button",{onClick:()=>s(!0),className:"bg-blue-600 hover:bg-blue-700 text-white p-3 rounded-xl flex items-center justify-center gap-2 transition-colors",children:[e.jsx(T,{size:18}),e.jsx("span",{className:"text-sm font-medium",children:"Mark Attendance"})]}),e.jsxs("button",{onClick:a,className:"bg-white border border-gray-200 hover:bg-gray-50 text-gray-700 p-3 rounded-xl flex items-center justify-center gap-2 transition-colors",children:[e.jsx(X,{size:18}),e.jsx("span",{className:"text-sm font-medium",children:"Export"})]})]})]}),pe=({form:t,setForm:s,teachers:a,handleAdd:r})=>e.jsxs("div",{className:"border-t border-gray-200 pt-4 mt-4 animate-in slide-in-from-top-2",children:[e.jsx("h3",{className:"text-md font-medium text-gray-800 mb-3",children:"Mark Attendance"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("select",{value:t.teacherId,onChange:n=>s({...t,teacherId:n.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"Select teacher"}),a.map(n=>e.jsx("option",{value:n.id,children:n.fullname},n.id))]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("input",{type:"time",value:t.checkInTime,onChange:n=>s({...t,checkInTime:n.target.value}),className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Check-in"}),e.jsx("input",{type:"time",value:t.checkOutTime,onChange:n=>s({...t,checkOutTime:n.target.value}),className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Check-out"})]}),e.jsxs("select",{value:t.status,onChange:n=>s({...t,status:n.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"present",children:"Present"}),e.jsx("option",{value:"absent",children:"Absent"}),e.jsx("option",{value:"late",children:"Late"}),e.jsx("option",{value:"half-day",children:"Half Day"})]}),e.jsx("input",{type:"text",value:t.remarks,onChange:n=>s({...t,remarks:n.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Remarks (optional)"}),e.jsxs("button",{onClick:r,className:"w-full bg-blue-600 hover:bg-blue-700 text-white p-3 rounded-lg flex items-center justify-center gap-2 font-medium transition-colors",children:[e.jsx(T,{size:20}),e.jsx("span",{children:"Save Attendance"})]})]})]}),be=({filtered:t,loading:s,error:a,getStatusColor:r})=>e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Today's Records"})}),s?e.jsxs("div",{className:"text-gray-500 text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-2",children:"Loading..."})]}):a?e.jsx("div",{className:"text-red-500 text-center py-8 bg-red-50 rounded-lg",children:e.jsxs("p",{children:["Error: ",a]})}):e.jsxs("div",{className:"space-y-3",children:[t.map(n=>e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:n.fullname}),e.jsx("p",{className:"text-sm text-gray-600",children:n.department})]}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${r(n.status)}`,children:n.status||"Unknown"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Check-in"}),e.jsx("p",{className:"font-medium text-gray-900",children:n.checkInTime||"-"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Check-out"}),e.jsx("p",{className:"font-medium text-gray-900",children:n.checkOutTime||"-"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Hours"}),e.jsxs("p",{className:"font-medium text-gray-900",children:[(n.workHours||0).toFixed(1),"h"]})]})]})]},n.id)),t.length===0&&e.jsxs("div",{className:"text-gray-500 text-center py-8 bg-gray-50 rounded-lg",children:[e.jsx(I,{size:32,className:"mx-auto mb-2 text-gray-400"}),e.jsx("p",{children:"No records found"})]})]})]}),fe="attendance",ye=J(Y,fe),je=async(t,s,a)=>{try{const r=new Date(a,s-1,1),n=new Date(a,s,0),m=Z(ye,w("teacherId","==",t),w("date",">=",r.toISOString().slice(0,10)),w("date","<=",n.toISOString().slice(0,10))),i=(await K(m)).docs.map(c=>c.data()),l=i.length,u=i.filter(c=>c.status==="present").length,g=i.filter(c=>c.status==="absent").length,y=i.filter(c=>c.status==="late").length,p=i.filter(c=>c.status==="half-day").length,b=i.reduce((c,d)=>c+(d.workHours||0),0),f=l>0?b/l:0,j=l>0?Math.round(u/l*100):0;return{totalDays:l,presentDays:u,absentDays:g,lateDays:y,halfDays:p,avgWorkHours:f,totalWorkHours:b,attendanceRating:j,lateCount:y,absentCount:g,halfDayCount:p}}catch(r){throw console.error("Error getting teacher attendance summary:",r),r}},ve=async(t,s)=>{try{const a=await getAllTeachers();return await Promise.all(a.map(n=>je(n.id,t,s)))}catch(a){throw console.error("Error getting all teachers attendance summary:",a),a}},Ne=({summary:t})=>{const s=t.totalDays>0?(t.presentDays/t.totalDays*100).toFixed(1):"0.0",a=t.totalDays>0?(t.totalWorkHours/t.presentDays).toFixed(1):"0.0";return e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Teacher Summary"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-xl text-center border border-blue-100",children:[e.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[s,"%"]}),e.jsx("div",{className:"text-sm text-blue-600 font-medium",children:"Attendance"})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-xl text-center border border-green-100",children:[e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:[a,"h"]}),e.jsx("div",{className:"text-sm text-green-600 font-medium",children:"Avg. Hours"})]}),e.jsxs("div",{className:"bg-red-50 p-4 rounded-xl text-center border border-red-100",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:t.absentCount}),e.jsx("div",{className:"text-sm text-red-600 font-medium",children:"Absent"})]}),e.jsxs("div",{className:"bg-yellow-50 p-4 rounded-xl text-center border border-yellow-100",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:t.lateCount}),e.jsx("div",{className:"text-sm text-yellow-600 font-medium",children:"Late"})]})]})]})},ke=({summary:t})=>{const s=t.totalDays>0?(t.presentDays/t.totalDays*100).toFixed(1):"0.0";return t.totalDays>0&&(t.totalWorkHours/t.presentDays).toFixed(1),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:t.fullname}),e.jsx("p",{className:"text-sm text-gray-600",children:t.department})]}),e.jsxs("span",{className:"px-2 py-1 rounded-full text-xs font-medium",children:[s,"%"]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Present"}),e.jsx("p",{className:"font-medium text-gray-900",children:t.presentDays})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Absent"}),e.jsx("p",{className:"font-medium text-gray-900",children:t.absentCount})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Late"}),e.jsx("p",{className:"font-medium text-gray-900",children:t.lateCount})]})]})]})},we=({stats:t,getWeekNumber:s,date:a})=>{const[r,n]=x.useState([]),[m,o]=x.useState(!1);return x.useEffect(()=>{(async()=>{o(!0);const l=await ve();n(l),o(!1)})()},[]),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Today's Overview"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-xl text-center border border-blue-100",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:t.daily.totalRecords}),e.jsx("div",{className:"text-sm text-blue-600 font-medium",children:"Total"})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-xl text-center border border-green-100",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:t.daily.presentCount}),e.jsx("div",{className:"text-sm text-green-600 font-medium",children:"Present"})]}),e.jsxs("div",{className:"bg-red-50 p-4 rounded-xl text-center border border-red-100",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:t.daily.absentCount}),e.jsx("div",{className:"text-sm text-red-600 font-medium",children:"Absent"})]}),e.jsxs("div",{className:"bg-yellow-50 p-4 rounded-xl text-center border border-yellow-100",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:t.daily.lateCount}),e.jsx("div",{className:"text-sm text-yellow-600 font-medium",children:"Late"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Performance Metrics"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-purple-50 rounded-lg border border-purple-100",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ne,{size:20,className:"text-purple-600"}),e.jsx("span",{className:"font-medium text-purple-900",children:"Average Hours"})]}),e.jsxs("span",{className:"text-xl font-bold text-purple-600",children:[t.daily.avgWorkHours.toFixed(1),"h"]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-cyan-50 rounded-lg border border-cyan-100",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(H,{size:20,className:"text-cyan-600"}),e.jsx("span",{className:"font-medium text-cyan-900",children:"Half Days"})]}),e.jsx("span",{className:"text-xl font-bold text-cyan-600",children:t.daily.halfDayCount})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-indigo-50 rounded-lg border border-indigo-100",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(C,{size:20,className:"text-indigo-600"}),e.jsx("span",{className:"font-medium text-indigo-900",children:"Week Number"})]}),e.jsx("span",{className:"text-xl font-bold text-indigo-600",children:s(a)})]})]})]}),r.map(i=>e.jsx(Ne,{summary:i},i.id)),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"All Teachers Summary"}),m?e.jsxs("div",{className:"text-gray-500 text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-2",children:"Loading..."})]}):e.jsx("div",{className:"space-y-3",children:r.map(i=>e.jsx(ke,{summary:i},i.id))})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Attendance Trends"}),e.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-100 h-48 rounded-xl flex items-center justify-center border border-blue-200",children:e.jsxs("div",{className:"text-center",children:[e.jsx(H,{size:32,className:"mx-auto mb-2 text-blue-500"}),e.jsx("p",{className:"text-blue-700 font-medium",children:"Line Chart Visualization"}),e.jsx("p",{className:"text-blue-600 text-sm",children:"Coming Soon"})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Status Distribution"}),e.jsx("div",{className:"bg-gradient-to-br from-green-50 to-emerald-100 h-48 rounded-xl flex items-center justify-center border border-green-200",children:e.jsxs("div",{className:"text-center",children:[e.jsx(te,{size:32,className:"mx-auto mb-2 text-green-500"}),e.jsx("p",{className:"text-green-700 font-medium",children:"Pie Chart Visualization"}),e.jsx("p",{className:"text-green-600 text-sm",children:"Coming Soon"})]})})]})]})},Ce=async(t,s)=>{const a=()=>{switch(s.reportType){case"all":return"All Teachers Attendance Report";case"teacher":return"Individual Teacher Attendance Report";case"week":return"Weekly Attendance Report";default:return"Teacher Attendance Report"}},r=()=>{let u="";return s.startDate&&s.endDate&&s.startDate!=="N/A"&&(u+=`<p><strong>Date Range:</strong> ${s.startDate} to ${s.endDate}</p>`),s.teacherId&&t[0]?.fullname&&(u+=`<p><strong>Teacher:</strong> ${t[0].fullname}</p>`),s.weekNum&&(u+=`<p><strong>Week:</strong> ${s.weekNum}</p>`),u},n=()=>`
      <tr>
        <th>Teacher</th>
        <th>Department</th>
        <th>Date</th>
        <th>Check-In</th>
        <th>Check-Out</th>
        <th>Work Hours</th>
        <th>Status</th>
      </tr>
    `,m=()=>t.map(u=>`
      <tr>
        <td>${u.fullname}</td>
        <td>${u.department}</td>
        <td>${u.date}</td>
        <td>${u.checkInTime||"-"}</td>
        <td>${u.checkOutTime||"-"}</td>
        <td>${u.workHours>0?`${u.workHours.toFixed(2)} hrs`:"-"}</td>
        <td>${u.status}</td>
      </tr>
    `).join(""),o=()=>{const u=t.length,g=t.filter(d=>d.status==="Present").length,y=t.filter(d=>d.status==="Absent").length,p=t.filter(d=>d.status==="Late").length,b=t.filter(d=>d.status==="Half Day").length,f=t.reduce((d,h)=>d+(h.workHours||0),0),j=u>0?f/u:0,c=u>0?Math.round(g/u*100):0;return`
      <div style="margin-top: 20px; padding: 15px; background-color: #f8f9fa; border-radius: 8px;">
        <h3 style="margin-top: 0; color: #333;">Report Summary</h3>
        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px;">
          <div><strong>Total Records:</strong> ${u}</div>
          <div><strong>Present:</strong> ${g}</div>
          <div><strong>Absent:</strong> ${y}</div>
          <div><strong>Late:</strong> ${p}</div>
          <div><strong>Half Day:</strong> ${b}</div>
          <div><strong>Total Work Hours:</strong> ${f.toFixed(1)} hrs</div>
          <div><strong>Average Work Hours:</strong> ${j.toFixed(1)} hrs</div>
          <div><strong>Attendance Rate:</strong> ${c}%</div>
        </div>
      </div>
    `},i=`
    <html>
      <head>
        <style>
          body { font-family: Arial, sans-serif; padding: 20px; background-color: #f8f9fa; }
          .container { max-width: 1200px; margin: 0 auto; background-color: white; padding: 30px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
          h1 { color: #333; text-align: center; margin-bottom: 30px; font-size: 28px; }
          h3 { color: #333; margin-bottom: 15px; }
          .header { margin-bottom: 30px; padding-bottom: 20px; border-bottom: 2px solid #e9ecef; }
          .filter-info { margin-bottom: 20px; font-size: 14px; color: #555; }
          .filter-info p { margin: 8px 0; }
          table { width: 100%; border-collapse: collapse; margin-top: 20px; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
          th, td { border: 1px solid #dee2e6; padding: 12px; text-align: left; }
          th { background-color: #f8f9fa; font-weight: 600; color: #495057; }
          tr:nth-child(even) { background-color: #f8f9fa; }
          tr:hover { background-color: #e9ecef; }
          .summary-section { margin-top: 30px; }
          .footer { margin-top: 40px; text-align: right; font-size: 12px; color: #6c757d; border-top: 1px solid #e9ecef; padding-top: 20px; }
        </style>
      </head>
      <body>
        <div class="container">
          <div class="header">
            <h1>${a()}</h1>
            <div class="filter-info">
              ${r()}
            </div>
          </div>
          
          <table>
            <thead>
              ${n()}
            </thead>
            <tbody>
              ${m()}
            </tbody>
          </table>
          
          <div class="summary-section">
            ${o()}
          </div>
          
          <div class="footer">
            <p>Generated on ${new Date().toLocaleDateString()} at ${new Date().toLocaleTimeString()}</p>
            <p>Total Records: ${t.length}</p>
          </div>
        </div>
      </body>
    </html>
  `,l=window.open("","_blank","noopener,noreferrer");return l?(l.document.open(),l.document.write(i),l.document.close(),l.focus(),setTimeout(()=>{l.print()},300),!0):null},Me=()=>{const{records:t,loading:s,error:a,loadByDate:r,saveRecord:n,stats:m,getWeekNumber:o}=me(),{teachers:i}=G(),[l,u]=x.useState(()=>new Date().toISOString().slice(0,10)),[g,y]=x.useState(""),[p,b]=x.useState({teacherId:"",checkInTime:"",checkOutTime:"",status:"present",remarks:""}),[f,j]=x.useState(!1),[c,d]=x.useState(!1),[h,k]=x.useState("records");x.useEffect(()=>{r(l)},[l,r]);const A=x.useMemo(()=>{if(!g)return t;const v=g.toLowerCase();return t.filter(S=>(S.fullname||"").toLowerCase().includes(v)||(S.department||"").toLowerCase().includes(v))},[t,g]),W=async v=>{v.preventDefault(),p.teacherId&&(await n({...p,date:l}),b({teacherId:"",checkInTime:"",checkOutTime:"",status:"present",remarks:""}),j(!1))},L=async()=>{await Ce(A,{reportType:"all",startDate:l,endDate:l})},O=v=>{switch(v){case"present":return"text-green-600 bg-green-50";case"absent":return"text-red-600 bg-red-50";case"late":return"text-yellow-600 bg-yellow-50";case"half-day":return"text-purple-600 bg-purple-50";default:return"text-gray-600 bg-gray-50"}};return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white shadow-sm border-b border-gray-200 sticky top-0 z-40",children:e.jsxs("div",{className:"px-4 py-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Attendance"}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{onClick:()=>k(h==="records"?"analytics":"records"),className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors",children:h==="records"?e.jsx(P,{size:20}):e.jsx(I,{size:20})})})]}),e.jsx(xe,{activeView:h,setActiveView:k})]})}),e.jsxs("div",{className:"p-4 pb-20",children:[h==="records"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx(ge,{showAddForm:f,setShowAddForm:j,handleExport:L}),f&&e.jsx(pe,{form:p,setForm:b,teachers:i,handleAdd:W}),e.jsx(he,{date:l,setDate:u,search:g,setSearch:y,showFilters:c,setShowFilters:d}),e.jsx(be,{filtered:A,loading:s,error:a,getStatusColor:O})]}),h==="analytics"&&e.jsx(we,{stats:m,getWeekNumber:o,date:l})]})]})};export{Me as default};
