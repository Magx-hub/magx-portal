import{c as H,j as e,X as de,C as je,U as ie,b as Ne}from"./index-6a5iavXQ.js";import{r as h}from"./router-LlB4DS0p.js";import{c as F,q as A,w as S,g as D,d as I,e as le,T,o as O,l as ue,a as me,u as xe,b as he}from"./firebase-CvZXCE_Y.js";import{d as N}from"./config-Dwf6l8zu.js";import{T as ce}from"./trending-up-BYbc-YN6.js";import{P as oe,S as we}from"./search-iFPtHTIM.js";import{D as re}from"./download-C-WS8eAT.js";import{S as pe,T as fe}from"./trash-2-DFdVx73x.js";import"./vendor-c5ypKtDW.js";/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Se=H("circle-alert",ve);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fe=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],ye=H("credit-card",Fe);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const De=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],ge=H("dollar-sign",De);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Ce=H("settings",ke),be=async c=>{try{const t=F(N,"feeStructures"),i=new Date;i.setHours(0,0,0,0);const r=A(t,S("department","==",c),S("effectiveDate","<=",T.fromDate(i)),O("effectiveDate","desc"),ue(1)),n=await D(r);if(n.empty)return null;const u=n.docs[0];return{id:u.id,...u.data(),effectiveDate:u.data().effectiveDate?.toDate?.()||u.data().effectiveDate}}catch(t){throw console.error("Error getting fee structure:",t),t}},Pe=async()=>{try{const c=F(N,"feeStructures"),t=A(c,O("department","asc"),O("effectiveDate","desc"));return(await D(t)).docs.map(r=>({id:r.id,...r.data(),effectiveDate:r.data().effectiveDate?.toDate?.()||r.data().effectiveDate}))}catch(c){throw console.error("Error getting all fee structures:",c),c}},Ae=async c=>{try{const t=F(N,"feeStructures"),{department:i,classesFee:r,canteenFee:n,breakfastFee:u,effectiveDate:s}=c,o={department:i,classesFee:Number(r),canteenFee:Number(n),breakfastFee:Number(u),effectiveDate:s instanceof Date?T.fromDate(s):T.fromDate(new Date(s)),createdAt:T.now(),updatedAt:T.now()};return(await me(t,o)).id}catch(t){throw console.error("Error adding fee structure:",t),t}},Ee=async(c,t)=>{try{const i=I(N,"feeStructures",c),{department:r,classesFee:n,canteenFee:u,breakfastFee:s,effectiveDate:o}=t,l={department:r,classesFee:Number(n),canteenFee:Number(u),breakfastFee:Number(s),effectiveDate:o instanceof Date?T.fromDate(o):T.fromDate(new Date(o)),updatedAt:T.now()};return await xe(i,l),!0}catch(i){throw console.error("Error updating fee structure:",i),i}},Te=async c=>{try{const t=I(N,"feeStructures",c);return await he(t),!0}catch(t){throw console.error("Error deleting fee structure:",t),t}},ne=async c=>{try{const t=F(N,"dailyPayments"),{studentId:i,classesFee:r,canteenFee:n,breakfastFee:u=0,otherFee:s=0,paymentMethod:o,notes:l,paymentDate:d=new Date().toISOString().split("T")[0]}=c,a=A(t,S("studentId","==",i),S("paymentDate","==",d));if(!(await D(a)).empty)throw new Error(`Payment already exists for student on ${d}`);const g=Number(r)+Number(n)+Number(u)+Number(s),w={studentId:i,paymentDate:d,classesFee:Number(r),canteenFee:Number(n),breakfastFee:Number(u),otherFee:Number(s),totalFee:g,paymentMethod:o,notes:l||"",createdAt:T.now(),updatedAt:T.now()};return(await me(t,w)).id}catch(t){throw console.error("Error recording daily payment:",t),t}},Re=async(c=null)=>{try{const t=c||new Date().toISOString().split("T")[0],i=F(N,"dailyPayments"),r=A(i,S("paymentDate","==",t)),n=await D(r);return(await Promise.all(n.docs.map(async s=>{const o=s.data(),l=I(N,"students",o.studentId),d=await le(l);if(d.exists()){const a=d.data();return{id:s.id,...o,studentName:a.fullname,studentDepartment:a.department,createdAt:o.createdAt?.toDate?.()||o.createdAt,updatedAt:o.updatedAt?.toDate?.()||o.updatedAt}}return{id:s.id,...o,studentName:"Unknown Student",studentDepartment:"Unknown Department",createdAt:o.createdAt?.toDate?.()||o.createdAt,updatedAt:o.updatedAt?.toDate?.()||o.updatedAt}}))).sort((s,o)=>s.studentName.localeCompare(o.studentName))}catch(t){throw console.error("Error getting daily payments:",t),t}},Ie=async(c=null)=>{try{const t=c||new Date().toISOString().split("T")[0],i=F(N,"students"),n=(await D(i)).docs.map(a=>({id:a.id,...a.data()})),u=F(N,"dailyPayments"),s=A(u,S("paymentDate","==",t)),o=await D(s),l=new Set(o.docs.map(a=>a.data().studentId));return n.filter(a=>!l.has(a.id)).sort((a,m)=>a.fullname.localeCompare(m.fullname))}catch(t){throw console.error("Error getting students not paid today:",t),t}},Me=async(c,t=null,i=null)=>{try{const r=F(N,"dailyPayments");let n;t&&i?n=A(r,S("studentId","==",c),S("paymentDate",">=",t),S("paymentDate","<=",i),O("paymentDate","desc")):n=A(r,S("studentId","==",c),O("paymentDate","desc"));const u=await D(n),s=I(N,"students",c),o=await le(s),l=o.exists()?o.data():null;return u.docs.map(d=>({id:d.id,...d.data(),studentName:l?.fullname||"Unknown Student",studentDepartment:l?.department||"Unknown Department",createdAt:d.data().createdAt?.toDate?.()||d.data().createdAt,updatedAt:d.data().updatedAt?.toDate?.()||d.data().updatedAt}))}catch(r){throw console.error("Error getting student payments:",r),r}},Oe=async(c,t)=>{try{const i=I(N,"dailyPayments",c),{classesFee:r,canteenFee:n,breakfastFee:u,otherFee:s,paymentMethod:o,notes:l}=t,d=Number(r)+Number(n)+Number(u)+Number(s),a={classesFee:Number(r),canteenFee:Number(n),breakfastFee:Number(u),otherFee:Number(s),totalFee:d,paymentMethod:o,notes:l||"",updatedAt:T.now()};return await xe(i,a),!0}catch(i){throw console.error("Error updating daily payment:",i),i}},qe=async c=>{try{const t=I(N,"dailyPayments",c);return await he(t),!0}catch(t){throw console.error("Error deleting daily payment:",t),t}},Le=async(c=null)=>{try{const t=c||new Date().toISOString().split("T")[0],i=F(N,"dailyPayments"),r=A(i,S("paymentDate","==",t)),n=await D(r);let u=0,s=0,o=0,l=0,d=0,a=0;const m=new Set;n.docs.forEach(f=>{const v=f.data();u++,s+=Number(v.classesFee||0),o+=Number(v.canteenFee||0),l+=Number(v.breakfastFee||0),d+=Number(v.otherFee||0),a+=Number(v.totalFee||0),m.add(v.studentId)});const g=F(N,"students"),j=(await D(g)).size,M=j-m.size;return{totalPayments:u,totalClassesFee:s,totalCanteenFee:o,totalBreakfastFee:l,totalOtherFee:d,totalAmount:a,uniqueStudents:m.size,studentsNotPaid:M,totalStudents:j}}catch(t){throw console.error("Error getting daily summary:",t),t}},Ue=async(c=null)=>{try{const t=c||new Date().toISOString().split("T")[0],i=F(N,"dailyPayments"),r=A(i,S("paymentDate","==",t)),n=await D(r),u=F(N,"students"),s=await D(u),o={};s.docs.forEach(d=>{o[d.id]=d.data()});const l={};return n.docs.forEach(d=>{const a=d.data(),g=o[a.studentId]?.department||"Unknown";l[g]||(l[g]={department:g,totalPayments:0,totalClassesFee:0,totalCanteenFee:0,totalBreakfastFee:0,totalOtherFee:0,totalAmount:0}),l[g].totalPayments++,l[g].totalClassesFee+=Number(a.classesFee||0),l[g].totalCanteenFee+=Number(a.canteenFee||0),l[g].totalBreakfastFee+=Number(a.breakfastFee||0),l[g].totalOtherFee+=Number(a.otherFee||0),l[g].totalAmount+=Number(a.totalFee||0)}),Object.values(l).sort((d,a)=>d.department.localeCompare(a.department))}catch(t){throw console.error("Error getting department summary:",t),t}},$e=async(c,t)=>{try{const i=F(N,"dailyPayments"),r=A(i,S("paymentDate",">=",c),S("paymentDate","<=",t),O("paymentDate","desc")),n=await D(r),u=F(N,"students"),s=await D(u),o={};return s.docs.forEach(d=>{o[d.id]=d.data()}),n.docs.map(d=>{const a=d.data(),m=o[a.studentId];return{id:d.id,...a,studentName:m?.fullname||"Unknown Student",studentDepartment:m?.department||"Unknown Department",createdAt:a.createdAt?.toDate?.()||a.createdAt,updatedAt:a.updatedAt?.toDate?.()||a.updatedAt}}).sort((d,a)=>{const m=a.paymentDate.localeCompare(d.paymentDate);return m===0?d.studentName.localeCompare(a.studentName):m})}catch(i){throw console.error("Error getting payment history:",i),i}},Be=async(c,t,i)=>{try{const r=F(N,"dailyPayments"),n=A(r,S("paymentDate",">=",t),S("paymentDate","<=",i)),u=await D(n);if(c==="department"){const s=F(N,"students"),o=await D(s),l={};o.docs.forEach(a=>{l[a.id]=a.data()});const d={};return u.docs.forEach(a=>{const m=a.data(),w=l[m.studentId]?.department||"Unknown";d[w]||(d[w]={department:w,totalAmount:0,totalPayments:0}),d[w].totalAmount+=Number(m.totalFee||0),d[w].totalPayments++}),Object.values(d).sort((a,m)=>a.department.localeCompare(m.department))}else if(c==="day"){const s={};return u.docs.forEach(o=>{const l=o.data(),d=l.paymentDate;s[d]||(s[d]={paymentDate:d,totalAmount:0,totalPayments:0}),s[d].totalAmount+=Number(l.totalFee||0),s[d].totalPayments++}),Object.values(s).sort((o,l)=>o.paymentDate.localeCompare(l.paymentDate))}else if(c==="week"){const s={};return u.docs.forEach(o=>{const l=o.data(),d=new Date(l.paymentDate),a=new Date(d.getFullYear(),0,1),m=(d-a)/864e5,g=Math.ceil((m+a.getDay()+1)/7),w=`${d.getFullYear()}-W${g.toString().padStart(2,"0")}`;s[w]||(s[w]={week:w,totalAmount:0,totalPayments:0}),s[w].totalAmount+=Number(l.totalFee||0),s[w].totalPayments++}),Object.values(s).sort((o,l)=>o.week.localeCompare(l.week))}else throw new Error('Invalid groupBy parameter. Use "department", "day", or "week".')}catch(r){throw console.error(`Error getting aggregated payments by ${c}:`,r),r}},ze=async(c,t=0,i=null)=>{try{const r=I(N,"students",c),n=await le(r);if(!n.exists())throw new Error("Student not found");const u=n.data(),s=await be(u.department);if(!s)throw new Error(`No fee structure found for department: ${u.department}`);const o=i!==null?i:s.breakfastFee,l=Number(s.classesFee)+Number(s.canteenFee)+Number(o)+Number(t);return{studentId:c,department:u.department,classesFee:s.classesFee,canteenFee:s.canteenFee,breakfastFee:o,otherFee:Number(t),totalFee:l}}catch(r){throw console.error("Error calculating student fee:",r),r}},He=async(c,t=null)=>{try{const i=t||new Date().toISOString().split("T")[0],r=F(N,"dailyPayments"),n=A(r,S("studentId","==",c),S("paymentDate","==",i),ue(1));return!(await D(n)).empty}catch(i){throw console.error("Error checking if student has paid:",i),i}},_e=()=>{const[c,t]=h.useState(!1),[i,r]=h.useState(null),[n,u]=h.useState([]),[s,o]=h.useState([]),[l,d]=h.useState([]),[a,m]=h.useState(null),[g,w]=h.useState([]),[j,M]=h.useState([]),f=h.useCallback(async(x,p=null,y=!0)=>{try{y&&t(!0),r(null);const P=await x();return p&&p(P),P}catch(P){throw console.error("Canteen operation error:",P),r(P.message||"An error occurred"),P}finally{y&&t(!1)}},[]),v=h.useCallback(async(x=null,p=!1)=>{const y=x||new Date().toISOString().split("T")[0];return!a||p?f(()=>Le(y),m):a},[a,f]),k=h.useCallback(async(x=null,p=!1)=>{const y=x||new Date().toISOString().split("T")[0];return s.length===0||p?f(()=>Re(y),o):s},[s,f]),C=h.useCallback(async(x=null,p=!1)=>{const y=x||new Date().toISOString().split("T")[0];return l.length===0||p?f(()=>Ie(y),d):l},[l,f]),_=h.useCallback(async x=>f(()=>be(x)),[f]),E=h.useCallback(async(x=!1)=>n.length===0||x?f(()=>Pe(),u):n,[n,f]),$=h.useCallback(async x=>{const p=await f(()=>Ae(x));return await E(!0),p},[f,E]),G=h.useCallback(async(x,p)=>{const y=await f(()=>Ee(x,p));return await E(!0),y},[f,E]),Y=h.useCallback(async x=>{const p=await f(()=>Te(x));return await E(!0),p},[f,E]),q=h.useCallback(async(x=null,p=!1)=>{const y=x||new Date().toISOString().split("T")[0];return g.length===0||p?f(()=>Ue(y),w):g},[g,f]),Q=h.useCallback(async(x,p,y=!1)=>j.length===0||y?f(()=>$e(x,p),M):j,[j,f]),V=h.useCallback(async(x,p,y)=>f(()=>Be(x,p,y)),[f]),K=h.useCallback(async x=>{const p=await f(()=>ne(x)),y=x.paymentDate||new Date().toISOString().split("T")[0];return await Promise.all([k(y,!0),C(y,!0),v(y,!0)]),p},[f,k,C,v]),W=h.useCallback(async(x,p=null,y=null)=>f(()=>Me(x,p,y)),[f]),X=h.useCallback(async(x,p)=>{const y=await f(()=>Oe(x,p));return await Promise.all([k(null,!0),v(null,!0)]),y},[f,k,v]),B=h.useCallback(async x=>{const p=await f(()=>qe(x));return await Promise.all([k(null,!0),C(null,!0),v(null,!0)]),p},[f,k,C,v]),J=h.useCallback(async(x,p=0,y=null)=>f(()=>ze(x,p,y),null,!1),[f]),Z=h.useCallback(async(x,p=null)=>f(()=>He(x,p),null,!1),[f]),ee=h.useCallback(async(x,p=null)=>{t(!0),r(null);try{const y=[],P=[];for(let b=0;b<x.length;b++)try{const R=await ne(x[b]);y.push({index:b,id:R,success:!0}),p&&p({completed:b+1,total:x.length,currentStudent:x[b].studentId,success:!0})}catch(R){console.error(`Error recording payment for index ${b}:`,R),P.push({index:b,error:R.message,studentId:x[b].studentId}),p&&p({completed:b+1,total:x.length,currentStudent:x[b].studentId,success:!1,error:R.message})}const U=x[0]?.paymentDate||new Date().toISOString().split("T")[0];return await Promise.all([k(U,!0),C(U,!0),v(U,!0)]),{successful:y,failed:P,totalProcessed:x.length,successCount:y.length,errorCount:P.length}}catch(y){throw console.error("Bulk payment operation failed:",y),r(y.message||"Bulk payment operation failed"),y}finally{t(!1)}},[ne,k,C,v]),L=h.useCallback(async(x=null)=>{const p=x||new Date().toISOString().split("T")[0];try{t(!0),r(null),await Promise.all([E(!0),k(p,!0),C(p,!0),v(p,!0),q(p,!0)])}catch(y){console.error("Failed to initialize canteen data:",y),r("Failed to load canteen data")}finally{t(!1)}},[E,k,C,v,q]),te=h.useCallback(()=>{u([]),o([]),d([]),m(null),w([]),M([]),r(null),t(!1)},[]),se=h.useCallback(async(x=null)=>{await L(x)},[L]),ae={totalFeeStructures:n.length,totalDailyPayments:s.length,totalUnpaidStudents:l.length,hasDailyData:s.length>0||l.length>0,dailyRevenue:a?.totalAmount||0,paymentRate:a?(a.uniqueStudents/a.totalStudents*100).toFixed(1):0};return{loading:c,feeStructures:n,dailyPayments:s,unpaidStudents:l,dailySummary:a,departmentSummary:g,paymentHistory:j,canteenStats:ae,fetchCurrentFeeStructure:_,fetchAllFeeStructures:E,createFeeStructure:$,modifyFeeStructure:G,removeFeeStructure:Y,recordPayment:K,fetchDailyPayments:k,fetchUnpaidStudents:C,fetchStudentPayments:W,modifyDailyPayment:X,removeDailyPayment:B,fetchDailySummary:v,fetchDepartmentSummary:q,fetchPaymentHistory:Q,fetchAggregatedPayments:V,calculateFee:J,checkStudentPaymentStatus:Z,bulkRecordPayments:ee,initializeCanteenData:L,clearCanteenData:te,refreshAllData:se,clearError:()=>r(null)}},z=({title:c,value:t,subtitle:i,icon:r,color:n="blue"})=>e.jsx("div",{className:`bg-white rounded-lg shadow-sm border-l-4 border-${n}-500 p-4`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:c}),e.jsx("p",{className:`text-2xl font-bold text-${n}-600`,children:t}),i&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:i})]}),e.jsx(r,{className:`h-8 w-8 text-${n}-500`})]})}),Ge=({isOpen:c,onClose:t,onSubmit:i,studentsNotPaid:r,selectedStudent:n=null,calculateFee:u})=>{const[s,o]=h.useState({studentId:"",classesFee:"",canteenFee:"",breakfastFee:"",otherFee:0,paymentMethod:"Cash",notes:""}),[l,d]=h.useState(!1);h.useEffect(()=>{s.studentId&&u&&(async()=>{try{d(!0);const g=await u(s.studentId,s.otherFee);o(w=>({...w,classesFee:g.classesFee,canteenFee:g.canteenFee,breakfastFee:g.breakfastFee}))}catch(g){console.error("Error calculating fees:",g)}finally{d(!1)}})()},[s.studentId,s.otherFee,u]),h.useEffect(()=>{n&&o(m=>({...m,studentId:n.id}))},[n]);const a=async()=>{try{d(!0),await i(s),o({studentId:"",classesFee:"",canteenFee:"",breakfastFee:"",otherFee:0,paymentMethod:"Cash",notes:""}),t()}catch(m){console.error("Error recording payment:",m)}finally{d(!1)}};return c?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Record Payment"}),e.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",disabled:l,children:e.jsx(de,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Student"}),e.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:s.studentId,onChange:m=>o({...s,studentId:m.target.value}),disabled:l,children:[e.jsx("option",{value:"",children:"Select Student"}),r.map(m=>e.jsxs("option",{value:m.id,children:[m.fullname," - ",m.department]},m.id))]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Classes Fee"}),e.jsx("input",{type:"number",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:s.classesFee,onChange:m=>o({...s,classesFee:m.target.value}),disabled:l})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Canteen Fee"}),e.jsx("input",{type:"number",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:s.canteenFee,onChange:m=>o({...s,canteenFee:m.target.value}),disabled:l})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Breakfast Fee"}),e.jsx("input",{type:"number",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:s.breakfastFee,onChange:m=>o({...s,breakfastFee:m.target.value}),disabled:l})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Other Fee"}),e.jsx("input",{type:"number",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:s.otherFee,onChange:m=>o({...s,otherFee:m.target.value}),disabled:l})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Payment Method"}),e.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:s.paymentMethod,onChange:m=>o({...s,paymentMethod:m.target.value}),disabled:l,children:[e.jsx("option",{value:"Cash",children:"Cash"}),e.jsx("option",{value:"Mobile Money",children:"Mobile Money"}),e.jsx("option",{value:"Bank Transfer",children:"Bank Transfer"}),e.jsx("option",{value:"Card",children:"Card"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes"}),e.jsx("textarea",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:"3",value:s.notes,onChange:m=>o({...s,notes:m.target.value}),placeholder:"Optional notes...",disabled:l})]}),e.jsxs("div",{className:"flex space-x-3 pt-4",children:[e.jsx("button",{onClick:t,className:"flex-1 px-4 py-2 text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-gray-500",disabled:l,children:"Cancel"}),e.jsx("button",{onClick:a,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50",disabled:l||!s.studentId,children:l?"Recording...":"Record Payment"})]})]})]})}):null},Ye=({isOpen:c,onClose:t,onSubmit:i,editingStructure:r=null})=>{const[n,u]=h.useState({department:r?.department||"",classesFee:r?.classesFee||"",canteenFee:r?.canteenFee||"",breakfastFee:r?.breakfastFee||"",effectiveDate:r?.effectiveDate?new Date(r.effectiveDate).toISOString().split("T")[0]:new Date().toISOString().split("T")[0]}),[s,o]=h.useState(!1),l=async()=>{try{o(!0),r?await i(r.id,n):await i(n),u({department:"",classesFee:"",canteenFee:"",breakfastFee:"",effectiveDate:new Date().toISOString().split("T")[0]}),t()}catch(d){console.error("Error saving fee structure:",d)}finally{o(!1)}};return c?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[e.jsx("h3",{className:"text-lg font-semibold",children:r?"Edit Fee Structure":"Add Fee Structure"}),e.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",disabled:s,children:e.jsx(de,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Department"}),e.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:n.department,onChange:d=>u({...n,department:d.target.value}),placeholder:"e.g., Computer Science",disabled:s})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Classes Fee"}),e.jsx("input",{type:"number",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:n.classesFee,onChange:d=>u({...n,classesFee:d.target.value}),disabled:s})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Canteen Fee"}),e.jsx("input",{type:"number",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:n.canteenFee,onChange:d=>u({...n,canteenFee:d.target.value}),disabled:s})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Breakfast Fee"}),e.jsx("input",{type:"number",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:n.breakfastFee,onChange:d=>u({...n,breakfastFee:d.target.value}),disabled:s})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Effective Date"}),e.jsx("input",{type:"date",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:n.effectiveDate,onChange:d=>u({...n,effectiveDate:d.target.value}),disabled:s})]}),e.jsxs("div",{className:"flex space-x-3 pt-4",children:[e.jsx("button",{onClick:t,className:"flex-1 px-4 py-2 text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-gray-500",disabled:s,children:"Cancel"}),e.jsx("button",{onClick:l,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50",disabled:s||!n.department||!n.classesFee||!n.canteenFee||!n.breakfastFee,children:s?"Saving...":r?"Update Structure":"Add Structure"})]})]})]})}):null},Qe=({selectedDate:c,onDateChange:t,dailySummary:i,unpaidStudents:r,dailyPayments:n,onShowPaymentModal:u,onSelectStudent:s,onSetActiveTab:o})=>e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-4",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(je,{className:"h-5 w-5 text-gray-500"}),e.jsx("input",{type:"date",value:c,onChange:l=>t(l.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500",children:"Update"})]})}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(z,{title:"Total Payments",value:i?.totalPayments||0,subtitle:"transactions today",icon:ye,color:"blue"}),e.jsx(z,{title:"Total Amount",value:`₵${(i?.totalAmount||0).toLocaleString()}`,subtitle:"collected today",icon:ge,color:"green"}),e.jsx(z,{title:"Students Paid",value:i?.uniqueStudents||0,subtitle:`${i?.studentsNotPaid||0} remaining`,icon:ie,color:"purple"}),e.jsx(z,{title:"Collection Rate",value:i?.totalStudents>0?`${Math.round(i.uniqueStudents/i.totalStudents*100)}%`:"0%",subtitle:"of total students",icon:ce,color:"orange"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("button",{onClick:()=>u(!0),className:"flex items-center justify-center space-x-2 bg-blue-600 text-white rounded-lg p-4 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx(oe,{className:"h-5 w-5"}),e.jsx("span",{children:"Record Payment"})]}),e.jsxs("button",{onClick:()=>o("reports"),className:"flex items-center justify-center space-x-2 bg-green-600 text-white rounded-lg p-4 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500",children:[e.jsx(re,{className:"h-5 w-5"}),e.jsx("span",{children:"Download Report"})]})]}),r.length>0&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Se,{className:"h-5 w-5 text-orange-500"}),e.jsx("h3",{className:"text-lg font-medium",children:"Students Not Paid Today"}),e.jsx("span",{className:"bg-orange-100 text-orange-800 px-2 py-1 rounded-full text-xs font-medium",children:r.length})]})}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"space-y-3",children:[r.slice(0,5).map(l=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-orange-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:l.fullname}),e.jsx("p",{className:"text-sm text-gray-500",children:l.department})]}),e.jsx("button",{onClick:()=>{s(l),u(!0)},className:"px-3 py-1 bg-blue-600 text-white text-sm rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500",children:"Pay Now"})]},l.id)),r.length>5&&e.jsxs("button",{onClick:()=>o("payments"),className:"w-full text-center text-blue-600 hover:text-blue-700 font-medium py-2",children:["View all ",r.length," students"]})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h3",{className:"text-lg font-medium",children:"Today's Payments"})}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"space-y-4",children:[n.slice(0,5).map(l=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-gray-900",children:l.studentName}),e.jsx("p",{className:"text-sm text-gray-500",children:l.studentDepartment})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-medium text-gray-900",children:["₵",l.totalFee]}),e.jsx("p",{className:"text-sm text-gray-500",children:l.paymentMethod})]})]},l.id)),n.length>5&&e.jsx("button",{onClick:()=>o("payments"),className:"w-full text-center text-blue-600 hover:text-blue-700 font-medium py-2",children:"View all payments"}),n.length===0&&e.jsx("div",{className:"text-center py-8 text-gray-500",children:e.jsx("p",{children:"No payments recorded today"})})]})})]})]}),Ve=({dailyPayments:c,searchTerm:t,onSearchChange:i,filterDepartment:r,onFilterChange:n,onShowPaymentModal:u,onEditPayment:s,onDeletePayment:o})=>{const l=c.filter(a=>{const m=a.studentName.toLowerCase().includes(t.toLowerCase())||a.studentDepartment.toLowerCase().includes(t.toLowerCase()),g=!r||a.studentDepartment===r;return m&&g}),d=[...new Set(c.map(a=>a.studentDepartment))].sort();return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row space-y-3 sm:space-y-0 sm:space-x-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(we,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search students...",value:t,onChange:a=>i(a.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("select",{value:r,onChange:a=>n(a.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"All Departments"}),d.map(a=>e.jsx("option",{value:a,children:a},a))]}),e.jsxs("button",{onClick:()=>u(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 flex items-center space-x-2",children:[e.jsx(oe,{className:"h-4 w-4"}),e.jsx("span",{children:"Add Payment"})]})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsxs("h3",{className:"text-lg font-medium",children:["Today's Payments (",l.length,")"]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Student"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Method"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Time"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:l.length>0?l.map(a=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:a.studentName}),e.jsx("div",{className:"text-sm text-gray-500",children:a.studentDepartment})]})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsxs("div",{className:"text-sm font-medium text-gray-900",children:["₵",a.totalFee]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Classes: ₵",a.classesFee," | Canteen: ₵",a.canteenFee," | Breakfast: ₵",a.breakfastFee,a.otherFee>0&&` | Other: ₵${a.otherFee}`]})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800",children:a.paymentMethod})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:a.createdAt?new Date(a.createdAt).toLocaleTimeString():"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx("button",{onClick:()=>s(a),className:"text-blue-600 hover:text-blue-900",title:"Edit Payment",children:e.jsx(pe,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>o(a.id),className:"text-red-600 hover:text-red-900",title:"Delete Payment",children:e.jsx(fe,{className:"h-4 w-4"})})]})})]},a.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"px-6 py-8 text-center text-gray-500",children:t||r?"No payments match your search criteria":"No payments recorded today"})})})]})})]})]})},Ke=({feeStructures:c,onShowFeeModal:t,onEditFeeStructure:i,onDeleteFeeStructure:r})=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Fee Structures"}),e.jsxs("button",{onClick:()=>t(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 flex items-center space-x-2",children:[e.jsx(oe,{className:"h-4 w-4"}),e.jsx("span",{children:"Add Structure"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:c.length>0?c.map(n=>e.jsx("div",{className:"bg-white rounded-lg shadow-sm border",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:n.department}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>i(n),className:"text-blue-600 hover:text-blue-900",title:"Edit Fee Structure",children:e.jsx(pe,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>r(n.id),className:"text-red-600 hover:text-red-900",title:"Delete Fee Structure",children:e.jsx(fe,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Classes Fee:"}),e.jsxs("span",{className:"text-sm font-medium",children:["₵",n.classesFee]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Canteen Fee:"}),e.jsxs("span",{className:"text-sm font-medium",children:["₵",n.canteenFee]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Breakfast Fee:"}),e.jsxs("span",{className:"text-sm font-medium",children:["₵",n.breakfastFee]})]}),e.jsx("hr",{}),e.jsxs("div",{className:"flex justify-between font-medium",children:[e.jsx("span",{className:"text-sm",children:"Total:"}),e.jsxs("span",{className:"text-sm",children:["₵",Number(n.classesFee)+Number(n.canteenFee)+Number(n.breakfastFee)]})]})]}),e.jsx("div",{className:"mt-4 pt-4 border-t",children:e.jsxs("p",{className:"text-xs text-gray-500",children:["Effective: ",n.effectiveDate?new Date(n.effectiveDate).toLocaleDateString():"N/A"]})})]})},n.id)):e.jsx("div",{className:"col-span-full text-center py-12",children:e.jsxs("div",{className:"text-gray-500",children:[e.jsx("p",{className:"text-lg font-medium",children:"No fee structures found"}),e.jsx("p",{className:"text-sm mt-2",children:"Create your first fee structure to get started"}),e.jsx("button",{onClick:()=>t(!0),className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500",children:"Add Fee Structure"})]})})})]}),We=({dailySummary:c,departmentSummary:t,selectedDate:i,onFetchPaymentHistory:r,onFetchAggregatedPayments:n})=>{const[u,s]=h.useState("daily"),[o,l]=h.useState(new Date().toISOString().split("T")[0]),[d,a]=h.useState(new Date().toISOString().split("T")[0]),[m,g]=h.useState(!1),w=async()=>{try{g(!0),u==="history"?await r(o,d):u==="aggregated"&&await n("department",o,d)}catch(j){console.error("Error generating report:",j)}finally{g(!1)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Generate Reports"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Report Type"}),e.jsxs("select",{value:u,onChange:j=>s(j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"daily",children:"Daily Summary"}),e.jsx("option",{value:"department",children:"Department Summary"}),e.jsx("option",{value:"history",children:"Payment History"}),e.jsx("option",{value:"aggregated",children:"Aggregated Report"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Date"}),e.jsx("input",{type:"date",value:o,onChange:j=>l(j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"End Date"}),e.jsx("input",{type:"date",value:d,onChange:j=>a(j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{onClick:w,disabled:m,className:"w-full px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50",children:m?"Generating...":"Generate"})})]})]}),u==="daily"&&c&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h3",{className:"text-lg font-medium",children:["Daily Summary - ",i]}),e.jsxs("button",{className:"flex items-center space-x-2 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700",children:[e.jsx(re,{className:"h-4 w-4"}),e.jsx("span",{children:"Export"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsx("div",{className:"bg-blue-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-blue-600",children:"Total Collections"}),e.jsxs("p",{className:"text-2xl font-bold text-blue-900",children:["₵",(c.totalAmount||0).toLocaleString()]})]}),e.jsx(ge,{className:"h-8 w-8 text-blue-500"})]})}),e.jsx("div",{className:"bg-green-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-green-600",children:"Students Paid"}),e.jsx("p",{className:"text-2xl font-bold text-green-900",children:c.uniqueStudents||0})]}),e.jsx(ie,{className:"h-8 w-8 text-green-500"})]})}),e.jsx("div",{className:"bg-orange-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-orange-600",children:"Payment Rate"}),e.jsxs("p",{className:"text-2xl font-bold text-orange-900",children:[c.totalStudents>0?Math.round(c.uniqueStudents/c.totalStudents*100):0,"%"]})]}),e.jsx(ce,{className:"h-8 w-8 text-orange-500"})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-medium mb-3",children:"Fee Breakdown"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Classes Fee:"}),e.jsxs("span",{className:"font-medium",children:["₵",(c.totalClassesFee||0).toLocaleString()]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Canteen Fee:"}),e.jsxs("span",{className:"font-medium",children:["₵",(c.totalCanteenFee||0).toLocaleString()]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Breakfast Fee:"}),e.jsxs("span",{className:"font-medium",children:["₵",(c.totalBreakfastFee||0).toLocaleString()]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Other Fee:"}),e.jsxs("span",{className:"font-medium",children:["₵",(c.totalOtherFee||0).toLocaleString()]})]}),e.jsx("hr",{}),e.jsxs("div",{className:"flex justify-between font-bold",children:[e.jsx("span",{children:"Total:"}),e.jsxs("span",{children:["₵",(c.totalAmount||0).toLocaleString()]})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-medium mb-3",children:"Payment Statistics"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Total Transactions:"}),e.jsx("span",{className:"font-medium",children:c.totalPayments||0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Students Paid:"}),e.jsx("span",{className:"font-medium",children:c.uniqueStudents||0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Students Remaining:"}),e.jsx("span",{className:"font-medium",children:c.studentsNotPaid||0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Total Students:"}),e.jsx("span",{className:"font-medium",children:c.totalStudents||0})]})]})]})]})]}),u==="department"&&t.length>0&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h3",{className:"text-lg font-medium",children:["Department Summary - ",i]}),e.jsxs("button",{className:"flex items-center space-x-2 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700",children:[e.jsx(re,{className:"h-4 w-4"}),e.jsx("span",{children:"Export"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Department"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Payments"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Amount"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Average per Student"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map(j=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:j.department}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:j.totalPayments}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:["₵",j.totalAmount.toLocaleString()]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:["₵",j.totalPayments>0?Math.round(j.totalAmount/j.totalPayments):0]})]},j.department))})]})})]}),!c&&!t.length&&e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-12 text-center",children:e.jsxs("div",{className:"text-gray-500",children:[e.jsx("p",{className:"text-lg font-medium",children:"No data available"}),e.jsx("p",{className:"text-sm mt-2",children:"Select a report type and date range to generate reports"})]})})]})},lt=()=>{const[c,t]=h.useState("dashboard"),[i,r]=h.useState(new Date().toISOString().split("T")[0]),[n,u]=h.useState(!1),[s,o]=h.useState(!1),[l,d]=h.useState(null),[a,m]=h.useState(null),[g,w]=h.useState(""),[j,M]=h.useState(""),{dailySummary:f,dailyPayments:v,feeStructures:k,unpaidStudents:C,departmentSummary:_,loading:E,error:$,recordPayment:G,createFeeStructure:Y,modifyFeeStructure:q,removeFeeStructure:Q,removeDailyPayment:V,calculateFee:K,fetchPaymentHistory:W,fetchAggregatedPayments:X,initializeCanteenData:B,refreshAllData:J}=_e();h.useEffect(()=>{B(i)},[i,B]);const Z=[{id:"dashboard",label:"Dashboard",icon:Ne},{id:"payments",label:"Payments",icon:ye},{id:"fees",label:"Fee Structures",icon:Ce},{id:"reports",label:"Reports",icon:ce}],ee=b=>{r(b)},L=async b=>{await G({...b,paymentDate:i}),d(null)},te=async b=>{await Y(b)},se=async(b,R)=>{await q(b,R),m(null)},ae=async b=>{window.confirm("Are you sure you want to delete this fee structure?")&&await Q(b)},x=b=>{m(b),o(!0)},p=async b=>{console.log("Edit payment:",b)},y=async b=>{window.confirm("Are you sure you want to delete this payment?")&&await V(b)},P=()=>{o(!1),m(null)},U=()=>{u(!1),d(null)};return E&&!f?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading canteen data..."})]})}):$?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-red-600 text-xl mb-4",children:"Error loading canteen data"}),e.jsx("p",{className:"text-gray-600 mb-4",children:$}),e.jsx("button",{onClick:()=>J(i),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Retry"})]})}):e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Canteen Management"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Manage daily payments, fee structures, and generate reports"})]}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm mb-6",children:e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"-mb-px flex space-x-8 px-6",children:Z.map(b=>{const R=b.icon;return e.jsxs("button",{onClick:()=>t(b.id),className:`py-4 px-1 border-b-2 font-medium text-sm flex items-center space-x-2 ${c===b.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(R,{className:"h-4 w-4"}),e.jsx("span",{children:b.label})]},b.id)})})})}),e.jsxs("div",{className:"tab-content",children:[c==="dashboard"&&e.jsx(Qe,{selectedDate:i,onDateChange:ee,dailySummary:f,unpaidStudents:C,dailyPayments:v,onShowPaymentModal:u,onSelectStudent:d,onSetActiveTab:t}),c==="payments"&&e.jsx(Ve,{dailyPayments:v,searchTerm:g,onSearchChange:w,filterDepartment:j,onFilterChange:M,onShowPaymentModal:u,onEditPayment:p,onDeletePayment:y}),c==="fees"&&e.jsx(Ke,{feeStructures:k,onShowFeeModal:o,onEditFeeStructure:x,onDeleteFeeStructure:ae}),c==="reports"&&e.jsx(We,{dailySummary:f,departmentSummary:_,selectedDate:i,onFetchPaymentHistory:W,onFetchAggregatedPayments:X})]}),e.jsx(Ge,{isOpen:n,onClose:U,onSubmit:L,studentsNotPaid:C,selectedStudent:l,calculateFee:K}),e.jsx(Ye,{isOpen:s,onClose:P,onSubmit:a?se:te,editingStructure:a})]})})};export{lt as default};
