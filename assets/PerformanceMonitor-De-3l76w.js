import{c as Fe,j as t,X as Ye,b as Je,U as Ze}from"./index-DsKkIWup.js";import{r as j,R as I}from"./router-DwwGQyGz.js";import{a as pe,c as D,s as P,g as K,q as V,o as Z,d as q,e as et,u as je,i as Se,w as te,b as Te,f as we}from"./firebase-CvZXCE_Y.js";import{d as A}from"./config-Dwf6l8zu.js";import{D as tt}from"./download-s73xugGz.js";import{I as ne,C as Ae}from"./Input-DVrF_iz6.js";import{i as st,d as Pe,D as at,f as rt,E as nt,L as Ne,e as fe,g as ot,A as it,h as oe,j as ct,k as Ee,l as lt,m as dt,n as $e,u as ut,G as ht,o as Be,p as mt,X as de,Y as ue,q as pt,R as ie,B as Ce,b as ye,T as ce,c as ke,r as ft,P as gt,a as yt,C as xt}from"./PieChart-CmydUAJu.js";import"./vendor-c5ypKtDW.js";/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bt=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],vt=Fe("arrow-left",bt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jt=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],St=Fe("upload",jt),M=({variant:a="primary",size:s="md",disabled:e=!1,loading:r=!1,icon:n,iconPosition:o="left",fullWidth:i=!1,children:u,className:b="",...f})=>{const d="inline-flex items-center justify-center font-medium rounded-lg transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",y={primary:"bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500 active:bg-blue-800",secondary:"bg-gray-100 text-gray-900 hover:bg-gray-200 focus:ring-gray-500 active:bg-gray-300",success:"bg-green-600 text-white hover:bg-green-700 focus:ring-green-500 active:bg-green-800",warning:"bg-yellow-600 text-white hover:bg-yellow-700 focus:ring-yellow-500 active:bg-yellow-800",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500 active:bg-red-800",outline:"border-2 border-blue-600 text-blue-600 hover:bg-blue-50 focus:ring-blue-500 active:bg-blue-100",ghost:"text-gray-700 hover:bg-gray-100 focus:ring-gray-500 active:bg-gray-200"},x={sm:"px-3 py-1.5 text-sm min-h-[36px]",md:"px-4 py-2 text-base min-h-[44px]",lg:"px-6 py-3 text-lg min-h-[52px]"},g={sm:16,md:20,lg:24},p=()=>t.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),w=`
    ${d}
    ${y[a]}
    ${x[s]}
    ${i?"w-full":""}
    ${b}
  `.trim();return t.jsxs("button",{className:w,disabled:e||r,...f,children:[r&&t.jsx(p,{}),!r&&n&&o==="left"&&t.jsx("span",{className:"mr-2",style:{fontSize:g[s]},children:n}),u,!r&&n&&o==="right"&&t.jsx("span",{className:"ml-2",style:{fontSize:g[s]},children:n})]})},wt=()=>{const[a,s]=j.useState([]),e=o=>{const i=Date.now()+Math.random();s(u=>[...u,{...o,id:i}])};return{toasts:a,removeToast:o=>{s(i=>i.filter(u=>u.id!==o))},toast:{success:(o,i={})=>e({type:"success",message:o,...i}),error:(o,i={})=>e({type:"error",message:o,...i}),warning:(o,i={})=>e({type:"warning",message:o,...i}),info:(o,i={})=>e({type:"info",message:o,...i})}}},ge=({isOpen:a=!1,onClose:s,title:e,size:r="md",showCloseButton:n=!0,closeOnBackdrop:o=!0,closeOnEscape:i=!0,children:u,className:b=""})=>{j.useEffect(()=>{if(i){const d=y=>{y.key==="Escape"&&a&&s?.()};return document.addEventListener("keydown",d),()=>document.removeEventListener("keydown",d)}},[a,s,i]),j.useEffect(()=>(a?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[a]);const f={sm:"max-w-md",md:"max-w-lg",lg:"max-w-2xl",xl:"max-w-4xl",full:"max-w-full mx-4"};return a?t.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:o?s:void 0}),t.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:t.jsxs("div",{className:`
            relative w-full ${f[r]} bg-white rounded-lg shadow-xl
            transform transition-all duration-300 ease-out
            ${b}
          `,onClick:d=>d.stopPropagation(),children:[(e||n)&&t.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e&&t.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:e}),n&&t.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 transition-colors p-1 rounded-md hover:bg-gray-100","aria-label":"Close modal",children:t.jsx(Ye,{size:20})})]}),t.jsx("div",{className:"p-6",children:u})]})})]}):null};var At=["type","layout","connectNulls","ref"],Nt=["key"];function ae(a){"@babel/helpers - typeof";return ae=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},ae(a)}function Me(a,s){if(a==null)return{};var e=Et(a,s),r,n;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(a);for(n=0;n<o.length;n++)r=o[n],!(s.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(a,r)&&(e[r]=a[r])}return e}function Et(a,s){if(a==null)return{};var e={};for(var r in a)if(Object.prototype.hasOwnProperty.call(a,r)){if(s.indexOf(r)>=0)continue;e[r]=a[r]}return e}function le(){return le=Object.assign?Object.assign.bind():function(a){for(var s=1;s<arguments.length;s++){var e=arguments[s];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(a[r]=e[r])}return a},le.apply(this,arguments)}function Re(a,s){var e=Object.keys(a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(a);s&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(a,n).enumerable})),e.push.apply(e,r)}return e}function L(a){for(var s=1;s<arguments.length;s++){var e=arguments[s]!=null?arguments[s]:{};s%2?Re(Object(e),!0).forEach(function(r){U(a,r,e[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(e)):Re(Object(e)).forEach(function(r){Object.defineProperty(a,r,Object.getOwnPropertyDescriptor(e,r))})}return a}function se(a){return Ot(a)||Dt(a)||kt(a)||Ct()}function Ct(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kt(a,s){if(a){if(typeof a=="string")return De(a,s);var e=Object.prototype.toString.call(a).slice(8,-1);if(e==="Object"&&a.constructor&&(e=a.constructor.name),e==="Map"||e==="Set")return Array.from(a);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return De(a,s)}}function Dt(a){if(typeof Symbol<"u"&&a[Symbol.iterator]!=null||a["@@iterator"]!=null)return Array.from(a)}function Ot(a){if(Array.isArray(a))return De(a)}function De(a,s){(s==null||s>a.length)&&(s=a.length);for(var e=0,r=new Array(s);e<s;e++)r[e]=a[e];return r}function Tt(a,s){if(!(a instanceof s))throw new TypeError("Cannot call a class as a function")}function Ie(a,s){for(var e=0;e<s.length;e++){var r=s[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,Ue(r.key),r)}}function Pt(a,s,e){return s&&Ie(a.prototype,s),e&&Ie(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function Bt(a,s,e){return s=xe(s),Mt(a,qe()?Reflect.construct(s,e||[],xe(a).constructor):s.apply(a,e))}function Mt(a,s){if(s&&(ae(s)==="object"||typeof s=="function"))return s;if(s!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Rt(a)}function Rt(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function qe(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(qe=function(){return!!a})()}function xe(a){return xe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},xe(a)}function It(a,s){if(typeof s!="function"&&s!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(s&&s.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),s&&Oe(a,s)}function Oe(a,s){return Oe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},Oe(a,s)}function U(a,s,e){return s=Ue(s),s in a?Object.defineProperty(a,s,{value:e,enumerable:!0,configurable:!0,writable:!0}):a[s]=e,a}function Ue(a){var s=_t(a,"string");return ae(s)=="symbol"?s:s+""}function _t(a,s){if(ae(a)!="object"||!a)return a;var e=a[Symbol.toPrimitive];if(e!==void 0){var r=e.call(a,s);if(ae(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(a)}var ee=(function(a){function s(){var e;Tt(this,s);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return e=Bt(this,s,[].concat(n)),U(e,"state",{isAnimationFinished:!0,totalLength:0}),U(e,"generateSimpleStrokeDasharray",function(i,u){return"".concat(u,"px ").concat(i-u,"px")}),U(e,"getStrokeDasharray",function(i,u,b){var f=b.reduce(function(C,O){return C+O});if(!f)return e.generateSimpleStrokeDasharray(u,i);for(var d=Math.floor(i/f),y=i%f,x=u-i,g=[],p=0,w=0;p<b.length;w+=b[p],++p)if(w+b[p]>y){g=[].concat(se(b.slice(0,p)),[y-w]);break}var S=g.length%2===0?[0,x]:[x];return[].concat(se(s.repeat(b,d)),se(g),S).map(function(C){return"".concat(C,"px")}).join(", ")}),U(e,"id",ut("recharts-line-")),U(e,"pathRef",function(i){e.mainCurve=i}),U(e,"handleAnimationEnd",function(){e.setState({isAnimationFinished:!0}),e.props.onAnimationEnd&&e.props.onAnimationEnd()}),U(e,"handleAnimationStart",function(){e.setState({isAnimationFinished:!1}),e.props.onAnimationStart&&e.props.onAnimationStart()}),e}return It(s,a),Pt(s,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var r=this.getTotalLength();this.setState({totalLength:r})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var r=this.getTotalLength();r!==this.state.totalLength&&this.setState({totalLength:r})}}},{key:"getTotalLength",value:function(){var r=this.mainCurve;try{return r&&r.getTotalLength&&r.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(r,n){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var o=this.props,i=o.points,u=o.xAxis,b=o.yAxis,f=o.layout,d=o.children,y=rt(d,nt);if(!y)return null;var x=function(w,S){return{x:w.x,y:w.y,value:w.value,errorVal:$e(w.payload,S)}},g={clipPath:r?"url(#clipPath-".concat(n,")"):null};return I.createElement(Ne,g,y.map(function(p){return I.cloneElement(p,{key:"bar-".concat(p.props.dataKey),data:i,xAxis:u,yAxis:b,layout:f,dataPointFormatter:x})}))}},{key:"renderDots",value:function(r,n,o){var i=this.props.isAnimationActive;if(i&&!this.state.isAnimationFinished)return null;var u=this.props,b=u.dot,f=u.points,d=u.dataKey,y=fe(this.props,!1),x=fe(b,!0),g=f.map(function(w,S){var C=L(L(L({key:"dot-".concat(S),r:3},y),x),{},{index:S,cx:w.x,cy:w.y,value:w.value,dataKey:d,payload:w.payload,points:f});return s.renderDotItem(b,C)}),p={clipPath:r?"url(#clipPath-".concat(n?"":"dots-").concat(o,")"):null};return I.createElement(Ne,le({className:"recharts-line-dots",key:"dots"},p),g)}},{key:"renderCurveStatically",value:function(r,n,o,i){var u=this.props,b=u.type,f=u.layout,d=u.connectNulls;u.ref;var y=Me(u,At),x=L(L(L({},fe(y,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:n?"url(#clipPath-".concat(o,")"):null,points:r},i),{},{type:b,layout:f,connectNulls:d});return I.createElement(ot,le({},x,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(r,n){var o=this,i=this.props,u=i.points,b=i.strokeDasharray,f=i.isAnimationActive,d=i.animationBegin,y=i.animationDuration,x=i.animationEasing,g=i.animationId,p=i.animateNewValues,w=i.width,S=i.height,C=this.state,O=C.prevPoints,m=C.totalLength;return I.createElement(it,{begin:d,duration:y,isActive:f,easing:x,from:{t:0},to:{t:1},key:"line-".concat(g),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(v){var T=v.t;if(O){var $=O.length/u.length,_=u.map(function(B,X){var z=Math.floor(X*$);if(O[z]){var F=O[z],Y=oe(F.x,B.x),be=oe(F.y,B.y);return L(L({},B),{},{x:Y(T),y:be(T)})}if(p){var he=oe(w*2,B.x),me=oe(S/2,B.y);return L(L({},B),{},{x:he(T),y:me(T)})}return L(L({},B),{},{x:B.x,y:B.y})});return o.renderCurveStatically(_,r,n)}var H=oe(0,m),W=H(T),G;if(b){var Q="".concat(b).split(/[,\s]+/gim).map(function(B){return parseFloat(B)});G=o.getStrokeDasharray(W,m,Q)}else G=o.generateSimpleStrokeDasharray(m,W);return o.renderCurveStatically(u,r,n,{strokeDasharray:G})})}},{key:"renderCurve",value:function(r,n){var o=this.props,i=o.points,u=o.isAnimationActive,b=this.state,f=b.prevPoints,d=b.totalLength;return u&&i&&i.length&&(!f&&d>0||!ct(f,i))?this.renderCurveWithAnimation(r,n):this.renderCurveStatically(i,r,n)}},{key:"render",value:function(){var r,n=this.props,o=n.hide,i=n.dot,u=n.points,b=n.className,f=n.xAxis,d=n.yAxis,y=n.top,x=n.left,g=n.width,p=n.height,w=n.isAnimationActive,S=n.id;if(o||!u||!u.length)return null;var C=this.state.isAnimationFinished,O=u.length===1,m=Pe("recharts-line",b),v=f&&f.allowDataOverflow,T=d&&d.allowDataOverflow,$=v||T,_=Ee(S)?this.id:S,H=(r=fe(i,!1))!==null&&r!==void 0?r:{r:3,strokeWidth:2},W=H.r,G=W===void 0?3:W,Q=H.strokeWidth,B=Q===void 0?2:Q,X=lt(i)?i:{},z=X.clipDot,F=z===void 0?!0:z,Y=G*2+B;return I.createElement(Ne,{className:m},v||T?I.createElement("defs",null,I.createElement("clipPath",{id:"clipPath-".concat(_)},I.createElement("rect",{x:v?x:x-g/2,y:T?y:y-p/2,width:v?g:g*2,height:T?p:p*2})),!F&&I.createElement("clipPath",{id:"clipPath-dots-".concat(_)},I.createElement("rect",{x:x-Y/2,y:y-Y/2,width:g+Y,height:p+Y}))):null,!O&&this.renderCurve($,_),this.renderErrorBar($,_),(O||i)&&this.renderDots($,F,_),(!w||C)&&dt.renderCallByParent(this.props,u))}}],[{key:"getDerivedStateFromProps",value:function(r,n){return r.animationId!==n.prevAnimationId?{prevAnimationId:r.animationId,curPoints:r.points,prevPoints:n.curPoints}:r.points!==n.curPoints?{curPoints:r.points}:null}},{key:"repeat",value:function(r,n){for(var o=r.length%2!==0?[].concat(se(r),[0]):r,i=[],u=0;u<n;++u)i=[].concat(se(i),se(o));return i}},{key:"renderDotItem",value:function(r,n){var o;if(I.isValidElement(r))o=I.cloneElement(r,n);else if(st(r))o=r(n);else{var i=n.key,u=Me(n,Nt),b=Pe("recharts-line-dot",typeof r!="boolean"?r.className:"");o=I.createElement(at,le({key:i},u,{className:b}))}return o}}])})(j.PureComponent);U(ee,"displayName","Line");U(ee,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!ht.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});U(ee,"getComposedData",function(a){var s=a.props,e=a.xAxis,r=a.yAxis,n=a.xAxisTicks,o=a.yAxisTicks,i=a.dataKey,u=a.bandSize,b=a.displayedData,f=a.offset,d=s.layout,y=b.map(function(x,g){var p=$e(x,i);return d==="horizontal"?{x:Be({axis:e,ticks:n,bandSize:u,entry:x,index:g}),y:Ee(p)?null:r.scale(p),value:p,payload:x}:{x:Ee(p)?null:e.scale(p),y:Be({axis:r,ticks:o,bandSize:u,entry:x,index:g}),value:p,payload:x}});return L({points:y,layout:d},f)});var Lt=mt({chartName:"LineChart",GraphicalChild:ee,axisComponents:[{axisType:"xAxis",AxisComp:de},{axisType:"yAxis",AxisComp:ue}],formatAxisMap:pt});const N={STUDENTS:"performance_students",SCORES:"performance_scores",BEHAVIOR:"performance_behavior",ASSESSMENTS:"performance_assessments"},_e=a=>{if(!a||typeof a!="object")throw new Error("Student data must be a valid object");if(!a.name||typeof a.name!="string"||a.name.trim().length===0)throw new Error("Student name is required and must be a non-empty string");if(!a.class||typeof a.class!="string"||a.class.trim().length===0)throw new Error("Student class is required and must be a non-empty string");if(a.attendance!==void 0&&(typeof a.attendance!="number"||a.attendance<0||a.attendance>100))throw new Error("Attendance must be a number between 0 and 100")},Ft=a=>{if(!a||typeof a!="object")throw new Error("Score data must be a valid object");if(!a.studentId||typeof a.studentId!="string")throw new Error("Student ID is required");if(!a.subject||typeof a.subject!="string"||!["math","science","english"].includes(a.subject))throw new Error("Subject must be one of: math, science, english");if(typeof a.score!="number"||a.score<0||a.score>100)throw new Error("Score must be a number between 0 and 100");if(a.type&&!["test","assignment"].includes(a.type))throw new Error("Type must be either test or assignment")},$t=a=>{if(!a||typeof a!="object")throw new Error("Behavior data must be a valid object");if(!a.studentId||typeof a.studentId!="string")throw new Error("Student ID is required");["participation","collaboration","discipline","criticalThinking"].forEach(e=>{if(a[e]!==void 0&&(typeof a[e]!="number"||a[e]<1||a[e]>5))throw new Error(`${e} must be a number between 1 and 5`)})};class qt{async createStudent(s){try{return _e(s),{id:(await pe(D(A,N.STUDENTS),{...s,createdAt:P(),updatedAt:P()})).id,...s}}catch(e){throw console.error("Error creating student:",e),e}}async getStudents(){try{return(await K(V(D(A,N.STUDENTS),Z("name")))).docs.map(e=>({id:e.id,...e.data()}))}catch(s){throw console.error("Error fetching students:",s),s}}async getStudent(s){try{const e=q(A,N.STUDENTS,s),r=await et(e);if(r.exists())return{id:r.id,...r.data()};throw new Error("Student not found")}catch(e){throw console.error("Error fetching student:",e),e}}async updateStudent(s,e){try{_e({...e,name:"dummy",class:"dummy"});const r=q(A,N.STUDENTS,s);return await je(r,{...e,updatedAt:P()}),{id:s,...e}}catch(r){throw console.error("Error updating student:",r),r}}async deleteStudent(s){try{const e=Se(A);e.delete(q(A,N.STUDENTS,s));const r=V(D(A,N.SCORES),te("studentId","==",s));(await K(r)).docs.forEach(u=>e.delete(u.ref));const o=V(D(A,N.BEHAVIOR),te("studentId","==",s));return(await K(o)).docs.forEach(u=>e.delete(u.ref)),await e.commit(),s}catch(e){throw console.error("Error deleting student:",e),e}}async addScore(s){try{return Ft(s),{id:(await pe(D(A,N.SCORES),{...s,createdAt:P(),updatedAt:P()})).id,...s}}catch(e){throw console.error("Error adding score:",e),e}}async getScoresByStudent(s){try{const e=V(D(A,N.SCORES),te("studentId","==",s),Z("createdAt","desc"));return(await K(e)).docs.map(n=>({id:n.id,...n.data()}))}catch(e){throw console.error("Error fetching scores:",e),e}}async getScoresBySubject(s){try{const e=V(D(A,N.SCORES),te("subject","==",s),Z("createdAt","desc"));return(await K(e)).docs.map(n=>({id:n.id,...n.data()}))}catch(e){throw console.error("Error fetching scores by subject:",e),e}}async updateScore(s,e){try{const r=q(A,N.SCORES,s);return await je(r,{...e,updatedAt:P()}),{id:s,...e}}catch(r){throw console.error("Error updating score:",r),r}}async deleteScore(s){try{return await Te(q(A,N.SCORES,s)),s}catch(e){throw console.error("Error deleting score:",e),e}}async addBehaviorAssessment(s){try{return $t(s),{id:(await pe(D(A,N.BEHAVIOR),{...s,createdAt:P(),updatedAt:P()})).id,...s}}catch(e){throw console.error("Error adding behavior assessment:",e),e}}async getBehaviorByStudent(s){try{const e=V(D(A,N.BEHAVIOR),te("studentId","==",s),Z("createdAt","desc"));return(await K(e)).docs.map(n=>({id:n.id,...n.data()}))}catch(e){throw console.error("Error fetching behavior assessments:",e),e}}async updateBehaviorAssessment(s,e){try{const r=q(A,N.BEHAVIOR,s);return await je(r,{...e,updatedAt:P()}),{id:s,...e}}catch(r){throw console.error("Error updating behavior assessment:",r),r}}async deleteBehaviorAssessment(s){try{return await Te(q(A,N.BEHAVIOR,s)),s}catch(e){throw console.error("Error deleting behavior assessment:",e),e}}async createAssessment(s){try{return{id:(await pe(D(A,N.ASSESSMENTS),{...s,createdAt:P(),updatedAt:P()})).id,...s}}catch(e){throw console.error("Error creating assessment:",e),e}}async getAssessments(){try{return(await K(V(D(A,N.ASSESSMENTS),Z("createdAt","desc")))).docs.map(e=>({id:e.id,...e.data()}))}catch(s){throw console.error("Error fetching assessments:",s),s}}async getClassAnalytics(){try{const[s,e,r]=await Promise.all([this.getStudents(),K(D(A,N.SCORES)),K(D(A,N.BEHAVIOR))]),n=e.docs.map(g=>({id:g.id,...g.data()})),o=r.docs.map(g=>({id:g.id,...g.data()})),i={},u=["math","science","english"];u.forEach(g=>{const p=n.filter(w=>w.subject===g);if(p.length>0){const w=p.reduce((S,C)=>S+C.score,0)/p.length;i[g]=Math.round(w)}else i[g]=0});const b=Math.round(Object.values(i).reduce((g,p)=>g+p,0)/u.length),f=s.length>0?Math.round(s.reduce((g,p)=>g+(p.attendance||0),0)/s.length):0,d=s.map(g=>{const p=n.filter(S=>S.studentId===g.id),w=p.length>0?p.reduce((S,C)=>S+C.score,0)/p.length:0;return{...g,average:w}}),y=d.reduce((g,p)=>p.average>g.average?p:g,{name:"N/A",average:0}),x=d.reduce((g,p)=>p.average<g.average?p:g,{name:"N/A",average:100});return{subjectAverages:i,overallAverage:b,attendanceAverage:f,topPerformer:y,needsImprovement:x,totalStudents:s.length,totalAssessments:n.length,studentAverages:d}}catch(s){throw console.error("Error calculating class analytics:",s),s}}async getStudentAnalytics(s){try{const[e,r,n]=await Promise.all([this.getStudent(s),this.getScoresByStudent(s),this.getBehaviorByStudent(s)]),o={},i=["math","science","english"];i.forEach(d=>{const y=r.filter(x=>x.subject===d);if(y.length>0){const x=y.reduce((g,p)=>g+p.score,0)/y.length;o[d]=Math.round(x)}else o[d]=0});const u=Math.round(Object.values(o).reduce((d,y)=>d+y,0)/i.length),b=n.length>0?n[0]:null,f=r.sort((d,y)=>new Date(d.createdAt?.toDate?.()||d.createdAt)-new Date(y.createdAt?.toDate?.()||y.createdAt)).map((d,y)=>({name:`Assessment ${y+1}`,[d.subject]:d.score,date:d.createdAt?.toDate?.()||new Date(d.createdAt)}));return{student:e,subjectAverages:o,overallAverage:u,scores:r,behaviors:n,latestBehavior:b,progressData:f}}catch(e){throw console.error("Error calculating student analytics:",e),e}}subscribeToStudents(s){const e=V(D(A,N.STUDENTS),Z("name"));return we(e,r=>{const n=r.docs.map(o=>({id:o.id,...o.data()}));s(n)},r=>{console.error("Error in students subscription:",r)})}subscribeToScores(s){const e=V(D(A,N.SCORES),Z("createdAt","desc"));return we(e,r=>{const n=r.docs.map(o=>({id:o.id,...o.data()}));s(n)},r=>{console.error("Error in scores subscription:",r)})}subscribeToStudentScores(s,e){const r=V(D(A,N.SCORES),te("studentId","==",s),Z("createdAt","desc"));return we(r,n=>{const o=n.docs.map(i=>({id:i.id,...i.data()}));e(o)},n=>{console.error("Error in student scores subscription:",n)})}async migrateDummyData(s){try{const e=Se(A),r={students:0,scores:0,behaviors:0};for(const n of s){const o=q(D(A,N.STUDENTS));e.set(o,{name:n.name,class:n.class,attendance:n.attendance,createdAt:P(),updatedAt:P()}),r.students++;for(const[u,b]of Object.entries(n.subjects))b.scores.forEach((f,d)=>{const y=q(D(A,N.SCORES));e.set(y,{studentId:o.id,subject:u,score:f,type:"test",assessmentName:`Test ${d+1}`,createdAt:P(),updatedAt:P()}),r.scores++}),b.assignments.forEach((f,d)=>{const y=q(D(A,N.SCORES));e.set(y,{studentId:o.id,subject:u,score:f,type:"assignment",assessmentName:`Assignment ${d+1}`,createdAt:P(),updatedAt:P()}),r.scores++});const i=q(D(A,N.BEHAVIOR));e.set(i,{studentId:o.id,participation:n.behavior.participation,collaboration:n.behavior.collaboration,discipline:n.behavior.discipline,criticalThinking:n.behavior.criticalThinking,notes:"Migrated from dummy data",createdAt:P(),updatedAt:P()}),r.behaviors++}return await e.commit(),console.log("Migration completed:",r),r}catch(e){throw console.error("Error migrating dummy data:",e),e}}async clearAllData(){try{const s=Se(A),e=[N.STUDENTS,N.SCORES,N.BEHAVIOR,N.ASSESSMENTS];for(const r of e)(await K(D(A,r))).docs.forEach(o=>s.delete(o.ref));await s.commit(),console.log("All performance data cleared")}catch(s){throw console.error("Error clearing data:",s),s}}}const R=new qt,Ut=[{id:1,name:"Kwame Doku",class:"Basic 5",attendance:95,subjects:{math:{scores:[85,92,78,88],assignments:[90,85]},science:{scores:[92,88,95,90],assignments:[94,89]},english:{scores:[78,85,82,88],assignments:[80,85]}},behavior:{participation:4,collaboration:5,discipline:4,criticalThinking:3}},{id:2,name:"James Aboagye",class:"Basic 5",attendance:88,subjects:{math:{scores:[72,68,75,70],assignments:[65,70]},science:{scores:[85,82,88,84],assignments:[80,82]},english:{scores:[90,92,88,94],assignments:[91,89]}},behavior:{participation:3,collaboration:4,discipline:3,criticalThinking:5}},{id:3,name:"Sophia Anna",class:"Basic 6",attendance:92,subjects:{math:{scores:[95,98,92,96],assignments:[97,94]},science:{scores:[88,92,90,94],assignments:[90,92]},english:{scores:[85,82,88,84],assignments:[86,83]}},behavior:{participation:5,collaboration:4,discipline:5,criticalThinking:4}}],zt=()=>{const[a,s]=j.useState({}),[e,r]=j.useState({}),[n,o]=j.useState({}),[i,u]=j.useState({}),[b,f]=j.useState(null),[d,y]=j.useState(null),[x,g]=j.useState({students:!1,scores:!1,behaviors:!1,analytics:!1,migration:!1}),[p,w]=j.useState(null),{toast:S}=wt(),[C,O]=j.useState([]),m=j.useCallback((c,l)=>{g(h=>({...h,[c]:l}))},[]),v=j.useCallback((c,l)=>{console.error(l,c);let h=l,E="general";c.name==="ValidationError"?(h=`Validation Error: ${c.message}`,E="validation"):c.name==="NetworkError"?(h=`Network Error: ${c.message}. Please check your connection.`,E="network"):c.name==="NotFoundError"?(h=`Not Found: ${c.message}`,E="notFound"):c.message&&(h=c.message),w({message:h,type:E}),S.error(h)},[S]),T=j.useCallback(async()=>{m("students",!0);try{const l=(await R.getStudents()).reduce((E,k)=>(E[k.id]=k,E),{});s(l);const h=Object.values(l);h.length>0&&!d&&y(h[0])}catch(c){v(c,"Failed to load students")}finally{m("students",!1)}},[m,v,d]),$=j.useCallback(async c=>{try{const l=await R.createStudent(c);return s(h=>({...h,[l.id]:l})),S.success("Student added successfully"),l}catch(l){throw v(l,"Failed to add student"),l}},[v,S]),_=j.useCallback(async(c,l)=>{try{const h=await R.updateStudent(c,l);return s(E=>({...E,[c]:{...E[c],...l}})),d?.id===c&&y(E=>({...E,...l})),S.success("Student updated successfully"),h}catch(h){throw v(h,"Failed to update student"),h}},[v,S,d]),H=j.useCallback(async c=>{try{if(await R.deleteStudent(c),s(l=>{const h={...l};return delete h[c],h}),d?.id===c){const l=Object.values(a).filter(h=>h.id!==c);y(l[0]||null)}S.success("Student deleted successfully")}catch(l){throw v(l,"Failed to delete student"),l}},[v,S,d,a]),W=j.useCallback(async c=>{try{const l=await R.addScore(c);return r(h=>({...h,[l.id]:l})),S.success("Score added successfully"),l}catch(l){throw v(l,"Failed to add score"),l}},[v,S]),G=j.useCallback(async(c,l)=>{try{const h=await R.updateScore(c,l);return r(E=>({...E,[c]:{...E[c],...l}})),S.success("Score updated successfully"),h}catch(h){throw v(h,"Failed to update score"),h}},[v,S]),Q=j.useCallback(async c=>{try{await R.deleteScore(c),r(l=>{const h={...l};return delete h[c],h}),S.success("Score deleted successfully")}catch(l){throw v(l,"Failed to delete score"),l}},[v,S]),B=j.useCallback(async c=>{try{const l=await R.addBehaviorAssessment(c);return o(h=>({...h,[l.id]:l})),S.success("Behavior assessment added successfully"),l}catch(l){throw v(l,"Failed to add behavior assessment"),l}},[v,S]),X=j.useCallback(async(c,l)=>{try{const h=await R.updateBehaviorAssessment(c,l);return o(E=>({...E,[c]:{...E[c],...l}})),S.success("Behavior assessment updated successfully"),h}catch(h){throw v(h,"Failed to update behavior assessment"),h}},[v,S]),z=j.useCallback(async c=>{try{await R.deleteBehaviorAssessment(c),o(l=>{const h={...l};return delete h[c],h}),S.success("Behavior assessment deleted successfully")}catch(l){throw v(l,"Failed to delete behavior assessment"),l}},[v,S]),F=j.useCallback(async()=>{m("analytics",!0);try{const c=await R.getClassAnalytics();f(c)}catch(c){v(c,"Failed to load class analytics")}finally{m("analytics",!1)}},[m,v]),Y=j.useCallback(async c=>{m("analytics",!0);try{return await R.getStudentAnalytics(c)}catch(l){return v(l,"Failed to load student analytics"),null}finally{m("analytics",!1)}},[m,v]),be=j.useCallback(async()=>{m("migration",!0);try{const c=await R.migrateDummyData(Ut);return S.success(`Migration completed: ${c.students} students, ${c.scores} scores, ${c.behaviors} behaviors`),await T(),await F(),c}catch(c){throw v(c,"Failed to migrate dummy data"),c}finally{m("migration",!1)}},[m,v,S,T,F]),he=j.useCallback(()=>{const c=R.subscribeToStudents(l=>{s(l),l.length>0&&!d&&y(l[0])});return O(l=>[...l,c]),c},[d]),me=j.useCallback(()=>{const c=R.subscribeToScores(l=>{r(l)});return O(l=>[...l,c]),c},[]),ze=j.useCallback(c=>{const l=R.subscribeToStudentScores(c,h=>{r(h)});return O(h=>[...h,l]),l},[]),re=j.useCallback(c=>{if(!c||!Object.keys(e).length)return{};const l=Object.values(e).filter(k=>k.studentId===c.id),h={};return["math","science","english"].forEach(k=>{const J=l.filter(ve=>ve.subject===k);if(J.length>0){const ve=J.reduce((Qe,Xe)=>Qe+Xe.score,0)/J.length;h[k]=Math.round(ve)}else h[k]=0}),h},[e]),Ke=j.useCallback(c=>{const l=re(c);return["math","science","english"].map(h=>({subject:h.charAt(0).toUpperCase()+h.slice(1),score:l[h]||0,max:100}))},[re]),Ve=j.useCallback(c=>{if(!c||!Object.keys(n).length)return[];const h=Object.values(n).filter(k=>k.studentId===c.id)[0];return h?["participation","collaboration","discipline","criticalThinking"].map(k=>({metric:k.charAt(0).toUpperCase()+k.slice(1).replace(/([A-Z])/g," $1").trim(),score:h[k]||0,max:5})):[]},[n]),He=j.useCallback(c=>{if(!c||!Object.keys(e).length)return[];const l=Object.values(e).filter(E=>E.studentId===c.id).sort((E,k)=>new Date(E.createdAt?.toDate?.()||E.createdAt)-new Date(k.createdAt?.toDate?.()||k.createdAt)),h=new Map;return l.forEach((E,k)=>{const J=`Assessment ${k+1}`;h.has(J)||h.set(J,{name:J}),h.get(J)[E.subject]=E.score}),Array.from(h.values())},[e]),We=j.useCallback(()=>b?b.subjectAverages||{}:{},[b]),Ge=j.useCallback(()=>!Object.keys(a).length||!Object.keys(e).length?[]:Object.values(a).map(c=>{const l=re(c),h=Object.values(l).length>0?Math.round(Object.values(l).reduce((E,k)=>E+k,0)/Object.values(l).length):0;return{name:c.name.split(" ")[0],average:h}}),[a,e,re]);return j.useEffect(()=>{T(),F();const c=he(),l=me();return()=>{C.forEach(h=>{typeof h=="function"&&h()}),c(),l()}},[]),j.useEffect(()=>()=>{C.forEach(c=>{typeof c=="function"&&c()})},[C]),{students:Object.values(a),scores:Object.values(e),behaviors:Object.values(n),assessments:Object.values(i),analytics:b,selectedStudent:d,loading:x,error:p,addStudent:$,updateStudent:_,deleteStudent:H,setSelectedStudent:y,addScore:W,updateScore:G,deleteScore:Q,addBehavior:B,updateBehavior:X,deleteBehavior:z,loadClassAnalytics:F,loadStudentAnalytics:Y,migrateDummyData:be,subscribeToStudents:he,subscribeToScores:me,subscribeToStudentScores:ze,calculateAverages:re,getAcademicData:Ke,getBehaviorData:Ve,getProgressData:He,getClassAverages:We,getStudentComparison:Ge,loadStudents:T,clearError:()=>w(null)}},Kt=({currentView:a,selectedStudent:s,students:e,onBackToDashboard:r,onDataInputView:n,onMigrateData:o})=>t.jsx("div",{className:"bg-white shadow-sm border-b",children:t.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:t.jsxs("div",{className:"flex items-center justify-between h-16",children:[t.jsxs("div",{className:"flex items-center",children:[a!=="dashboard"&&t.jsxs(M,{onClick:r,variant:"ghost",className:"mr-4",children:[t.jsx(vt,{className:"h-4 w-4 mr-2"}),"Back"]}),t.jsxs("div",{className:"flex items-center",children:[t.jsx(Je,{className:"h-6 w-6 text-blue-600 mr-3"}),t.jsxs("div",{children:[t.jsxs("h1",{className:"text-xl font-semibold text-gray-900",children:[a==="dashboard"&&"Performance Dashboard",a==="student"&&`${s?.name} - Performance Details`,a==="input"&&"Data Input"]}),t.jsxs("p",{className:"text-sm text-gray-500",children:[a==="dashboard"&&"Monitor and analyze student performance",a==="student"&&"Academic scores and behavioral assessments",a==="input"&&"Add scores and behavioral data"]})]})]})]}),t.jsxs("div",{className:"flex items-center space-x-3",children:[a==="dashboard"&&t.jsxs(t.Fragment,{children:[t.jsxs(M,{onClick:n,variant:"outline",className:"hidden sm:flex",children:[t.jsx(St,{className:"h-4 w-4 mr-2"}),"Add Data"]}),t.jsxs(M,{onClick:o,variant:"outline",className:"hidden sm:flex",children:[t.jsx(tt,{className:"h-4 w-4 mr-2"}),"Sample Data"]})]}),t.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[t.jsx(Ze,{className:"h-4 w-4 mr-1"}),e.length," Students"]})]})]})})}),Vt=["math","science","english"],Ht=({analytics:a,classAverages:s,studentComparison:e,onMigrateData:r})=>t.jsxs("div",{className:"space-y-8",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("h2",{className:"text-3xl font-bold text-gray-700",children:"Class Performance Overview"}),t.jsx(M,{onClick:r,variant:"outline",size:"sm",children:"Migrate Data"})]}),t.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:[{title:"Class Average",value:a?`${a.overallAverage}%`:"0%"},{title:"Top Performer",value:a?.topPerformer?.name?.split(" ")[0]||"N/A",subValue:a?`${Math.round(a.topPerformer.average)}%`:"0%"},{title:"Attendance Rate",value:a?`${a.attendanceAverage}%`:"0%"},{title:"Total Students",value:a?.totalStudents||0}].map(n=>t.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg transition-transform transform hover:-translate-y-1",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-600",children:n.title}),t.jsx("p",{className:"text-3xl font-bold text-indigo-600 mt-2",children:n.value}),n.subValue&&t.jsx("p",{className:"text-xl font-semibold text-gray-500",children:n.subValue})]},n.title))}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[t.jsxs("div",{className:"bg-white p-4 sm:p-6 rounded-xl shadow-lg",children:[t.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Subject Averages"}),t.jsx(ie,{width:"100%",height:300,children:t.jsxs(Ce,{data:Vt.map(n=>({subject:n.charAt(0).toUpperCase()+n.slice(1),average:s[n]||0})),children:[t.jsx(ye,{strokeDasharray:"3 3"}),t.jsx(de,{dataKey:"subject"}),t.jsx(ue,{}),t.jsx(ce,{}),t.jsx(ke,{dataKey:"average",fill:"#4f46e5"})]})})]}),t.jsxs("div",{className:"bg-white p-4 sm:p-6 rounded-xl shadow-lg",children:[t.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Student Comparison"}),t.jsx(ie,{width:"100%",height:300,children:t.jsxs(Ce,{data:e,children:[t.jsx(ye,{strokeDasharray:"3 3"}),t.jsx(de,{dataKey:"name"}),t.jsx(ue,{}),t.jsx(ce,{}),t.jsx(ke,{dataKey:"average",fill:"#10b981"})]})})]})]})]}),Le=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884D8"],Wt=({students:a,selectedStudent:s,onStudentSelect:e,getAcademicData:r,getBehaviorData:n,getProgressData:o})=>{const[i,u]=j.useState("academic"),b=({targetTab:f,children:d})=>t.jsx("button",{className:`py-2 px-4 font-medium transition-colors duration-200 ${i===f?"border-b-2 border-indigo-600 text-indigo-600":"text-gray-500 hover:text-gray-700"}`,onClick:()=>u(f),children:d});return s?t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center bg-white p-4 rounded-xl shadow-lg",children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-700",children:"Student Details"}),t.jsx("select",{className:"mt-2 md:mt-0 w-full md:w-auto p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",value:s.id,onChange:f=>e(a.find(d=>d.id===f.target.value)),children:a.map(f=>t.jsxs("option",{value:f.id,children:[f.name," - ",f.class]},f.id))})]}),t.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg",children:[t.jsx("h3",{className:"text-2xl font-bold",children:s.name}),t.jsxs("p",{className:"text-gray-600",children:["Class: ",s.class]}),t.jsxs("p",{className:"text-gray-600",children:["Attendance: ",s.attendance,"%"]})]}),t.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-4 sm:p-6",children:[t.jsx("div",{className:"border-b border-gray-200",children:t.jsxs("nav",{className:"-mb-px flex space-x-6","aria-label":"Tabs",children:[t.jsx(b,{targetTab:"academic",children:"Academic Performance"}),t.jsx(b,{targetTab:"behavioral",children:"Behavioral Metrics"})]})}),t.jsxs("div",{className:"mt-6",children:[i==="academic"&&t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[t.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[t.jsx("h3",{className:"text-xl font-semibold mb-4 text-center",children:"Subject Scores"}),t.jsx(ie,{width:"100%",height:300,children:t.jsxs(Ce,{data:r(s),children:[t.jsx(ye,{strokeDasharray:"3 3"}),t.jsx(de,{dataKey:"subject"}),t.jsx(ue,{}),t.jsx(ce,{}),t.jsx(ke,{dataKey:"score",fill:"#4f46e5"})]})})]}),t.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[t.jsx("h3",{className:"text-xl font-semibold mb-4 text-center",children:"Progress Over Time"}),t.jsx(ie,{width:"100%",height:300,children:t.jsxs(Lt,{data:o(s),children:[t.jsx(ye,{strokeDasharray:"3 3"}),t.jsx(de,{dataKey:"name"}),t.jsx(ue,{}),t.jsx(ce,{}),t.jsx(ft,{}),t.jsx(ee,{type:"monotone",dataKey:"math",stroke:"#8884d8"}),t.jsx(ee,{type:"monotone",dataKey:"science",stroke:"#82ca9d"}),t.jsx(ee,{type:"monotone",dataKey:"english",stroke:"#ffc658"})]})})]})]}),i==="behavioral"&&t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 items-center",children:[t.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[t.jsx("h3",{className:"text-xl font-semibold mb-4 text-center",children:"Behavioral Assessment"}),t.jsx(ie,{width:"100%",height:300,children:t.jsxs(gt,{children:[t.jsx(yt,{data:n(s),cx:"50%",cy:"50%",labelLine:!1,outerRadius:100,fill:"#8884d8",dataKey:"score",label:({metric:f,score:d})=>`${f.split(" ")[0]}: ${d}`,children:n(s).map((f,d)=>t.jsx(xt,{fill:Le[d%Le.length]},`cell-${d}`))}),t.jsx(ce,{})]})})]}),t.jsxs("div",{className:"bg-gray-50 p-6 rounded-lg",children:[t.jsx("h4",{className:"text-xl font-semibold mb-4",children:"Detailed Ratings (1-5 scale)"}),t.jsx("ul",{className:"space-y-3 text-gray-700",children:n(s).map(f=>t.jsxs("li",{className:"flex justify-between items-center",children:[t.jsxs("span",{className:"font-medium",children:[f.metric,":"]}),t.jsx("span",{className:"font-bold text-lg text-indigo-600 bg-indigo-100 rounded-full px-3 py-1",children:f.score})]},f.metric))})]})]})]})]})]}):t.jsx("div",{className:"text-center py-12",children:t.jsx("p",{className:"text-gray-600",children:"No student selected"})})},Gt=["math","science","english"],Qt=["participation","collaboration","discipline","criticalThinking"],Xt=({students:a,onAddStudent:s,onAddScore:e,onAddBehavior:r})=>{const[n,o]=j.useState(!1),[i,u]=j.useState(!1),[b,f]=j.useState(!1),[d,y]=j.useState({name:"",class:"",attendance:""}),[x,g]=j.useState({studentId:"",subject:"math",score:"",type:"test",assessmentName:""}),[p,w]=j.useState({studentId:"",participation:3,collaboration:3,discipline:3,criticalThinking:3,notes:""}),S=async m=>{m.preventDefault();try{await s({name:d.name,class:d.class,attendance:d.attendance?parseInt(d.attendance):void 0}),o(!1),y({name:"",class:"",attendance:""})}catch(v){console.error("Failed to add student:",v)}},C=async m=>{m.preventDefault();try{await e({studentId:x.studentId,subject:x.subject,score:parseInt(x.score),type:x.type,assessmentName:x.assessmentName||`${x.type} Assessment`}),u(!1),g({studentId:"",subject:"math",score:"",type:"test",assessmentName:""})}catch(v){console.error("Failed to add score:",v)}},O=async m=>{m.preventDefault();try{await r({studentId:p.studentId,participation:parseInt(p.participation),collaboration:parseInt(p.collaboration),discipline:parseInt(p.discipline),criticalThinking:parseInt(p.criticalThinking),notes:p.notes}),f(!1),w({studentId:"",participation:3,collaboration:3,discipline:3,criticalThinking:3,notes:""})}catch(v){console.error("Failed to add behavior assessment:",v)}};return t.jsxs("div",{className:"max-w-2xl mx-auto space-y-6",children:[t.jsxs("div",{className:"bg-white p-8 rounded-xl shadow-lg",children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-700 mb-6",children:"Input Student Data"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[t.jsx(M,{onClick:()=>o(!0),variant:"primary",className:"w-full",children:"Add Student"}),t.jsx(M,{onClick:()=>u(!0),variant:"outline",className:"w-full",children:"Add Academic Score"}),t.jsx(M,{onClick:()=>f(!0),variant:"secondary",className:"w-full",children:"Add Behavior Assessment"})]}),t.jsx("div",{className:"text-center text-gray-600",children:t.jsx("p",{children:"Use the buttons above to add students, academic scores, or behavioral assessments."})})]}),t.jsx(ge,{isOpen:n,onClose:()=>o(!1),title:"Add Student",children:t.jsxs("form",{onSubmit:S,className:"p-6 space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Student Name"}),t.jsx(ne,{type:"text",value:d.name,onChange:m=>y({...d,name:m.target.value}),placeholder:"Enter student name",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Class"}),t.jsx(ne,{type:"text",value:d.class,onChange:m=>y({...d,class:m.target.value}),placeholder:"e.g., Basic 5, JHS 1",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Attendance Rate (Optional)"}),t.jsx(ne,{type:"number",min:"0",max:"100",value:d.attendance,onChange:m=>y({...d,attendance:m.target.value}),placeholder:"e.g., 95"})]}),t.jsxs("div",{className:"flex justify-end space-x-4 pt-4",children:[t.jsx(M,{type:"button",onClick:()=>o(!1),variant:"outline",children:"Cancel"}),t.jsx(M,{type:"submit",variant:"primary",children:"Add Student"})]})]})}),t.jsx(ge,{isOpen:i,onClose:()=>u(!1),title:"Add Academic Score",children:t.jsxs("form",{onSubmit:C,className:"p-6 space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Student"}),t.jsxs("select",{value:x.studentId,onChange:m=>g({...x,studentId:m.target.value}),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500",required:!0,children:[t.jsx("option",{value:"",children:"Select a student"}),a.map(m=>t.jsx("option",{value:m.id,children:m.name},m.id))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject"}),t.jsx("select",{value:x.subject,onChange:m=>g({...x,subject:m.target.value}),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500",children:Gt.map(m=>t.jsx("option",{value:m,children:m.charAt(0).toUpperCase()+m.slice(1)},m))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Assessment Type"}),t.jsxs("select",{value:x.type,onChange:m=>g({...x,type:m.target.value}),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500",children:[t.jsx("option",{value:"test",children:"Test"}),t.jsx("option",{value:"assignment",children:"Assignment"}),t.jsx("option",{value:"quiz",children:"Quiz"}),t.jsx("option",{value:"project",children:"Project"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Score (0-100)"}),t.jsx(ne,{type:"number",min:"0",max:"100",value:x.score,onChange:m=>g({...x,score:m.target.value}),required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Assessment Name (Optional)"}),t.jsx(ne,{type:"text",value:x.assessmentName,onChange:m=>g({...x,assessmentName:m.target.value}),placeholder:"e.g., Midterm Exam, Chapter 5 Quiz"})]}),t.jsxs("div",{className:"flex justify-end space-x-4 pt-4",children:[t.jsx(M,{type:"button",onClick:()=>u(!1),variant:"outline",children:"Cancel"}),t.jsx(M,{type:"submit",variant:"primary",children:"Add Score"})]})]})}),t.jsx(ge,{isOpen:b,onClose:()=>f(!1),title:"Add Behavior Assessment",children:t.jsxs("form",{onSubmit:O,className:"p-6 space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Student"}),t.jsxs("select",{value:p.studentId,onChange:m=>w({...p,studentId:m.target.value}),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500",required:!0,children:[t.jsx("option",{value:"",children:"Select a student"}),a.map(m=>t.jsx("option",{value:m.id,children:m.name},m.id))]})]}),Qt.map(m=>t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[m.charAt(0).toUpperCase()+m.slice(1).replace(/([A-Z])/g," $1").trim()," (1-5)"]}),t.jsx("select",{value:p[m],onChange:v=>w({...p,[m]:v.target.value}),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500",children:[1,2,3,4,5].map(v=>t.jsx("option",{value:v,children:v},v))})]},m)),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes (Optional)"}),t.jsx("textarea",{value:p.notes,onChange:m=>w({...p,notes:m.target.value}),rows:"3",className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500",placeholder:"Additional observations or comments..."})]}),t.jsxs("div",{className:"flex justify-end space-x-4 pt-4",children:[t.jsx(M,{type:"button",onClick:()=>f(!1),variant:"outline",children:"Cancel"}),t.jsx(M,{type:"submit",variant:"primary",children:"Add Assessment"})]})]})})]})},Yt=({currentView:a,selectedStudent:s,students:e,scores:r,behaviors:n,loading:o,error:i,onStudentSelect:u,onDataInputClick:b,getClassAnalytics:f,getStudentScores:d,getStudentBehaviors:y,getStudentAnalytics:x,addStudent:g,updateStudent:p,deleteStudent:w,addScore:S,updateScore:C,deleteScore:O,addBehavior:m,updateBehavior:v,deleteBehavior:T,clearAllData:$,onMigrateData:_})=>(()=>{if(o&&e.length===0)return t.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:t.jsxs(Ae,{className:"p-8 text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),t.jsx("p",{className:"text-gray-600",children:"Loading performance data..."})]})});if(i)return t.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:t.jsxs(Ae,{className:"p-8 text-center border-red-200 bg-red-50",children:[t.jsx("p",{className:"text-red-600 mb-4",children:i}),t.jsx(M,{onClick:()=>window.location.reload(),variant:"outline",children:"Retry"})]})});if(e.length===0)return t.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:t.jsxs(Ae,{className:"p-8 text-center",children:[t.jsx("h2",{className:"text-xl font-bold text-gray-700 mb-4",children:"No Performance Data Found"}),t.jsx("p",{className:"text-gray-600 mb-6",children:"It looks like you don't have any student performance data yet. Would you like to migrate some sample data to get started?"}),t.jsx(M,{onClick:_,variant:"primary",children:"Migrate Sample Data"})]})});switch(a){case"dashboard":return t.jsx(Ht,{students:e,scores:r,behaviors:n,onStudentSelect:u,onDataInputClick:b,getClassAnalytics:f});case"student":return t.jsx(Wt,{student:s,scores:d(s?.id),behaviors:y(s?.id),analytics:x(s?.id)});case"input":return t.jsx(Xt,{students:e,onAddStudent:g,onUpdateStudent:p,onDeleteStudent:w,onAddScore:S,onUpdateScore:C,onDeleteScore:O,onAddBehavior:m,onUpdateBehavior:v,onDeleteBehavior:T,onClearAllData:$});default:return null}})(),Jt=({isOpen:a,onClose:s,onMigrate:e,loading:r})=>t.jsx(ge,{isOpen:a,onClose:s,title:"Migrate Sample Data",children:t.jsxs("div",{className:"p-6",children:[t.jsx("p",{className:"text-gray-600 mb-6",children:"This will add sample student data including academic scores and behavioral assessments. This action cannot be undone."}),t.jsxs("div",{className:"flex justify-end space-x-4",children:[t.jsx(M,{onClick:s,variant:"outline",children:"Cancel"}),t.jsx(M,{onClick:e,variant:"primary",disabled:r,children:r?"Migrating...":"Migrate Data"})]})]})}),is=()=>{const[a,s]=j.useState("dashboard"),[e,r]=j.useState(null),[n,o]=j.useState(!1),{students:i,scores:u,behaviors:b,loading:f,error:d,addStudent:y,updateStudent:x,deleteStudent:g,addScore:p,updateScore:w,deleteScore:S,addBehavior:C,updateBehavior:O,deleteBehavior:m,migrateData:v,clearAllData:T,getStudentScores:$,getStudentBehaviors:_,getClassAnalytics:H,getStudentAnalytics:W}=zt(),G=async()=>{await v(),o(!1)},Q=F=>{r(F),s("student")},B=()=>{s("dashboard"),r(null)},X=()=>{s("input")},z=()=>{o(!0)};return t.jsxs("div",{className:"min-h-screen bg-gray-50",children:[t.jsx(Kt,{currentView:a,selectedStudent:e,students:i,onBackToDashboard:B,onDataInputView:X,onMigrateData:z}),t.jsx(Yt,{currentView:a,selectedStudent:e,students:i,scores:u,behaviors:b,loading:f,error:d,onStudentSelect:Q,onDataInputClick:X,getClassAnalytics:H,getStudentScores:$,getStudentBehaviors:_,getStudentAnalytics:W,addStudent:y,updateStudent:x,deleteStudent:g,addScore:p,updateScore:w,deleteScore:S,addBehavior:C,updateBehavior:O,deleteBehavior:m,clearAllData:T,onMigrateData:z}),t.jsx(Jt,{isOpen:n,onClose:()=>o(!1),onMigrate:G,loading:f})]})};export{is as default};
