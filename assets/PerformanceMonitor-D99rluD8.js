import{c as Fe,j as e,X as Ye,b as Je,U as Ze}from"./index-DW3707e6.js";import{r as j,R as I}from"./router-DwwGQyGz.js";import{a as pe,c as D,s as B,g as H,q as W,o as Z,d as z,e as et,u as je,i as Se,w as te,b as Te,f as we}from"./firebase-CvZXCE_Y.js";import{d as A}from"./config-Dwf6l8zu.js";import{D as tt}from"./download-dZiRdjaR.js";import{I as ne,C as Ae}from"./Input-r_odRC5l.js";import{i as st,d as Pe,D as at,f as rt,E as nt,L as Ne,e as fe,g as ot,A as it,h as oe,j as ct,k as ke,l as lt,m as dt,n as $e,u as ut,G as ht,o as Be,p as mt,X as de,Y as ue,q as pt,R as ie,B as Ce,b as xe,T as ce,c as Ee,r as ft,P as gt,a as xt,C as yt}from"./PieChart-DaKqGV-x.js";import"./vendor-c5ypKtDW.js";/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vt=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],bt=Fe("arrow-left",vt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jt=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],St=Fe("upload",jt),O=({variant:a="primary",size:s="md",disabled:t=!1,loading:r=!1,icon:n,iconPosition:i="left",fullWidth:o=!1,children:u,className:x="",...f})=>{const d="inline-flex items-center justify-center font-medium rounded-lg transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",y={primary:"bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500 active:bg-blue-800",secondary:"bg-gray-100 text-gray-900 hover:bg-gray-200 focus:ring-gray-500 active:bg-gray-300",success:"bg-green-600 text-white hover:bg-green-700 focus:ring-green-500 active:bg-green-800",warning:"bg-yellow-600 text-white hover:bg-yellow-700 focus:ring-yellow-500 active:bg-yellow-800",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500 active:bg-red-800",outline:"border-2 border-blue-600 text-blue-600 hover:bg-blue-50 focus:ring-blue-500 active:bg-blue-100",ghost:"text-gray-700 hover:bg-gray-100 focus:ring-gray-500 active:bg-gray-200"},v={sm:"px-3 py-1.5 text-sm min-h-[36px]",md:"px-4 py-2 text-base min-h-[44px]",lg:"px-6 py-3 text-lg min-h-[52px]"},g={sm:16,md:20,lg:24},p=()=>e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),w=`
    ${d}
    ${y[a]}
    ${v[s]}
    ${o?"w-full":""}
    ${x}
  `.trim();return e.jsxs("button",{className:w,disabled:t||r,...f,children:[r&&e.jsx(p,{}),!r&&n&&i==="left"&&e.jsx("span",{className:"mr-2",style:{fontSize:g[s]},children:n}),u,!r&&n&&i==="right"&&e.jsx("span",{className:"ml-2",style:{fontSize:g[s]},children:n})]})},wt=()=>{const[a,s]=j.useState([]),t=i=>{const o=Date.now()+Math.random();s(u=>[...u,{...i,id:o}])};return{toasts:a,removeToast:i=>{s(o=>o.filter(u=>u.id!==i))},toast:{success:(i,o={})=>t({type:"success",message:i,...o}),error:(i,o={})=>t({type:"error",message:i,...o}),warning:(i,o={})=>t({type:"warning",message:i,...o}),info:(i,o={})=>t({type:"info",message:i,...o})}}},ge=({isOpen:a=!1,onClose:s,title:t,size:r="md",showCloseButton:n=!0,closeOnBackdrop:i=!0,closeOnEscape:o=!0,children:u,className:x=""})=>{j.useEffect(()=>{if(o){const d=y=>{y.key==="Escape"&&a&&s?.()};return document.addEventListener("keydown",d),()=>document.removeEventListener("keydown",d)}},[a,s,o]),j.useEffect(()=>(a?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[a]);const f={sm:"max-w-md",md:"max-w-lg",lg:"max-w-2xl",xl:"max-w-4xl",full:"max-w-full mx-4"};return a?e.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:i?s:void 0}),e.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:e.jsxs("div",{className:`
            relative w-full ${f[r]} bg-white rounded-lg shadow-xl
            transform transition-all duration-300 ease-out
            ${x}
          `,onClick:d=>d.stopPropagation(),children:[(t||n)&&e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[t&&e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:t}),n&&e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 transition-colors p-1 rounded-md hover:bg-gray-100","aria-label":"Close modal",children:e.jsx(Ye,{size:20})})]}),e.jsx("div",{className:"p-6",children:u})]})})]}):null};var At=["type","layout","connectNulls","ref"],Nt=["key"];function ae(a){"@babel/helpers - typeof";return ae=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},ae(a)}function Re(a,s){if(a==null)return{};var t=kt(a,s),r,n;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(a);for(n=0;n<i.length;n++)r=i[n],!(s.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(a,r)&&(t[r]=a[r])}return t}function kt(a,s){if(a==null)return{};var t={};for(var r in a)if(Object.prototype.hasOwnProperty.call(a,r)){if(s.indexOf(r)>=0)continue;t[r]=a[r]}return t}function le(){return le=Object.assign?Object.assign.bind():function(a){for(var s=1;s<arguments.length;s++){var t=arguments[s];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(a[r]=t[r])}return a},le.apply(this,arguments)}function Me(a,s){var t=Object.keys(a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(a);s&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(a,n).enumerable})),t.push.apply(t,r)}return t}function F(a){for(var s=1;s<arguments.length;s++){var t=arguments[s]!=null?arguments[s]:{};s%2?Me(Object(t),!0).forEach(function(r){K(a,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(t)):Me(Object(t)).forEach(function(r){Object.defineProperty(a,r,Object.getOwnPropertyDescriptor(t,r))})}return a}function se(a){return Ot(a)||Dt(a)||Et(a)||Ct()}function Ct(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Et(a,s){if(a){if(typeof a=="string")return De(a,s);var t=Object.prototype.toString.call(a).slice(8,-1);if(t==="Object"&&a.constructor&&(t=a.constructor.name),t==="Map"||t==="Set")return Array.from(a);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return De(a,s)}}function Dt(a){if(typeof Symbol<"u"&&a[Symbol.iterator]!=null||a["@@iterator"]!=null)return Array.from(a)}function Ot(a){if(Array.isArray(a))return De(a)}function De(a,s){(s==null||s>a.length)&&(s=a.length);for(var t=0,r=new Array(s);t<s;t++)r[t]=a[t];return r}function Tt(a,s){if(!(a instanceof s))throw new TypeError("Cannot call a class as a function")}function Le(a,s){for(var t=0;t<s.length;t++){var r=s[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,Ue(r.key),r)}}function Pt(a,s,t){return s&&Le(a.prototype,s),t&&Le(a,t),Object.defineProperty(a,"prototype",{writable:!1}),a}function Bt(a,s,t){return s=ye(s),Rt(a,qe()?Reflect.construct(s,t||[],ye(a).constructor):s.apply(a,t))}function Rt(a,s){if(s&&(ae(s)==="object"||typeof s=="function"))return s;if(s!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Mt(a)}function Mt(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function qe(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(qe=function(){return!!a})()}function ye(a){return ye=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ye(a)}function Lt(a,s){if(typeof s!="function"&&s!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(s&&s.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),s&&Oe(a,s)}function Oe(a,s){return Oe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},Oe(a,s)}function K(a,s,t){return s=Ue(s),s in a?Object.defineProperty(a,s,{value:t,enumerable:!0,configurable:!0,writable:!0}):a[s]=t,a}function Ue(a){var s=It(a,"string");return ae(s)=="symbol"?s:s+""}function It(a,s){if(ae(a)!="object"||!a)return a;var t=a[Symbol.toPrimitive];if(t!==void 0){var r=t.call(a,s);if(ae(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(a)}var ee=(function(a){function s(){var t;Tt(this,s);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return t=Bt(this,s,[].concat(n)),K(t,"state",{isAnimationFinished:!0,totalLength:0}),K(t,"generateSimpleStrokeDasharray",function(o,u){return"".concat(u,"px ").concat(o-u,"px")}),K(t,"getStrokeDasharray",function(o,u,x){var f=x.reduce(function(C,T){return C+T});if(!f)return t.generateSimpleStrokeDasharray(u,o);for(var d=Math.floor(o/f),y=o%f,v=u-o,g=[],p=0,w=0;p<x.length;w+=x[p],++p)if(w+x[p]>y){g=[].concat(se(x.slice(0,p)),[y-w]);break}var S=g.length%2===0?[0,v]:[v];return[].concat(se(s.repeat(x,d)),se(g),S).map(function(C){return"".concat(C,"px")}).join(", ")}),K(t,"id",ut("recharts-line-")),K(t,"pathRef",function(o){t.mainCurve=o}),K(t,"handleAnimationEnd",function(){t.setState({isAnimationFinished:!0}),t.props.onAnimationEnd&&t.props.onAnimationEnd()}),K(t,"handleAnimationStart",function(){t.setState({isAnimationFinished:!1}),t.props.onAnimationStart&&t.props.onAnimationStart()}),t}return Lt(s,a),Pt(s,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var r=this.getTotalLength();this.setState({totalLength:r})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var r=this.getTotalLength();r!==this.state.totalLength&&this.setState({totalLength:r})}}},{key:"getTotalLength",value:function(){var r=this.mainCurve;try{return r&&r.getTotalLength&&r.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(r,n){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var i=this.props,o=i.points,u=i.xAxis,x=i.yAxis,f=i.layout,d=i.children,y=rt(d,nt);if(!y)return null;var v=function(w,S){return{x:w.x,y:w.y,value:w.value,errorVal:$e(w.payload,S)}},g={clipPath:r?"url(#clipPath-".concat(n,")"):null};return I.createElement(Ne,g,y.map(function(p){return I.cloneElement(p,{key:"bar-".concat(p.props.dataKey),data:o,xAxis:u,yAxis:x,layout:f,dataPointFormatter:v})}))}},{key:"renderDots",value:function(r,n,i){var o=this.props.isAnimationActive;if(o&&!this.state.isAnimationFinished)return null;var u=this.props,x=u.dot,f=u.points,d=u.dataKey,y=fe(this.props,!1),v=fe(x,!0),g=f.map(function(w,S){var C=F(F(F({key:"dot-".concat(S),r:3},y),v),{},{index:S,cx:w.x,cy:w.y,value:w.value,dataKey:d,payload:w.payload,points:f});return s.renderDotItem(x,C)}),p={clipPath:r?"url(#clipPath-".concat(n?"":"dots-").concat(i,")"):null};return I.createElement(Ne,le({className:"recharts-line-dots",key:"dots"},p),g)}},{key:"renderCurveStatically",value:function(r,n,i,o){var u=this.props,x=u.type,f=u.layout,d=u.connectNulls;u.ref;var y=Re(u,At),v=F(F(F({},fe(y,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:n?"url(#clipPath-".concat(i,")"):null,points:r},o),{},{type:x,layout:f,connectNulls:d});return I.createElement(ot,le({},v,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(r,n){var i=this,o=this.props,u=o.points,x=o.strokeDasharray,f=o.isAnimationActive,d=o.animationBegin,y=o.animationDuration,v=o.animationEasing,g=o.animationId,p=o.animateNewValues,w=o.width,S=o.height,C=this.state,T=C.prevPoints,m=C.totalLength;return I.createElement(it,{begin:d,duration:y,isActive:f,easing:v,from:{t:0},to:{t:1},key:"line-".concat(g),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(b){var P=b.t;if(T){var U=T.length/u.length,L=u.map(function(R,X){var V=Math.floor(X*U);if(T[V]){var q=T[V],Y=oe(q.x,R.x),ve=oe(q.y,R.y);return F(F({},R),{},{x:Y(P),y:ve(P)})}if(p){var he=oe(w*2,R.x),me=oe(S/2,R.y);return F(F({},R),{},{x:he(P),y:me(P)})}return F(F({},R),{},{x:R.x,y:R.y})});return i.renderCurveStatically(L,r,n)}var G=oe(0,m),$=G(P),_;if(x){var Q="".concat(x).split(/[,\s]+/gim).map(function(R){return parseFloat(R)});_=i.getStrokeDasharray($,m,Q)}else _=i.generateSimpleStrokeDasharray(m,$);return i.renderCurveStatically(u,r,n,{strokeDasharray:_})})}},{key:"renderCurve",value:function(r,n){var i=this.props,o=i.points,u=i.isAnimationActive,x=this.state,f=x.prevPoints,d=x.totalLength;return u&&o&&o.length&&(!f&&d>0||!ct(f,o))?this.renderCurveWithAnimation(r,n):this.renderCurveStatically(o,r,n)}},{key:"render",value:function(){var r,n=this.props,i=n.hide,o=n.dot,u=n.points,x=n.className,f=n.xAxis,d=n.yAxis,y=n.top,v=n.left,g=n.width,p=n.height,w=n.isAnimationActive,S=n.id;if(i||!u||!u.length)return null;var C=this.state.isAnimationFinished,T=u.length===1,m=Pe("recharts-line",x),b=f&&f.allowDataOverflow,P=d&&d.allowDataOverflow,U=b||P,L=ke(S)?this.id:S,G=(r=fe(o,!1))!==null&&r!==void 0?r:{r:3,strokeWidth:2},$=G.r,_=$===void 0?3:$,Q=G.strokeWidth,R=Q===void 0?2:Q,X=lt(o)?o:{},V=X.clipDot,q=V===void 0?!0:V,Y=_*2+R;return I.createElement(Ne,{className:m},b||P?I.createElement("defs",null,I.createElement("clipPath",{id:"clipPath-".concat(L)},I.createElement("rect",{x:b?v:v-g/2,y:P?y:y-p/2,width:b?g:g*2,height:P?p:p*2})),!q&&I.createElement("clipPath",{id:"clipPath-dots-".concat(L)},I.createElement("rect",{x:v-Y/2,y:y-Y/2,width:g+Y,height:p+Y}))):null,!T&&this.renderCurve(U,L),this.renderErrorBar(U,L),(T||o)&&this.renderDots(U,q,L),(!w||C)&&dt.renderCallByParent(this.props,u))}}],[{key:"getDerivedStateFromProps",value:function(r,n){return r.animationId!==n.prevAnimationId?{prevAnimationId:r.animationId,curPoints:r.points,prevPoints:n.curPoints}:r.points!==n.curPoints?{curPoints:r.points}:null}},{key:"repeat",value:function(r,n){for(var i=r.length%2!==0?[].concat(se(r),[0]):r,o=[],u=0;u<n;++u)o=[].concat(se(o),se(i));return o}},{key:"renderDotItem",value:function(r,n){var i;if(I.isValidElement(r))i=I.cloneElement(r,n);else if(st(r))i=r(n);else{var o=n.key,u=Re(n,Nt),x=Pe("recharts-line-dot",typeof r!="boolean"?r.className:"");i=I.createElement(at,le({key:o},u,{className:x}))}return i}}])})(j.PureComponent);K(ee,"displayName","Line");K(ee,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!ht.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});K(ee,"getComposedData",function(a){var s=a.props,t=a.xAxis,r=a.yAxis,n=a.xAxisTicks,i=a.yAxisTicks,o=a.dataKey,u=a.bandSize,x=a.displayedData,f=a.offset,d=s.layout,y=x.map(function(v,g){var p=$e(v,o);return d==="horizontal"?{x:Be({axis:t,ticks:n,bandSize:u,entry:v,index:g}),y:ke(p)?null:r.scale(p),value:p,payload:v}:{x:ke(p)?null:t.scale(p),y:Be({axis:r,ticks:i,bandSize:u,entry:v,index:g}),value:p,payload:v}});return F({points:y,layout:d},f)});var _t=mt({chartName:"LineChart",GraphicalChild:ee,axisComponents:[{axisType:"xAxis",AxisComp:de},{axisType:"yAxis",AxisComp:ue}],formatAxisMap:pt});const N={STUDENTS:"performance_students",SCORES:"performance_scores",BEHAVIOR:"performance_behavior",ASSESSMENTS:"performance_assessments"},Ie=a=>{if(!a||typeof a!="object")throw new Error("Student data must be a valid object");if(!a.name||typeof a.name!="string"||a.name.trim().length===0)throw new Error("Student name is required and must be a non-empty string");if(!a.class||typeof a.class!="string"||a.class.trim().length===0)throw new Error("Student class is required and must be a non-empty string");if(a.attendance!==void 0&&(typeof a.attendance!="number"||a.attendance<0||a.attendance>100))throw new Error("Attendance must be a number between 0 and 100")},Ft=a=>{if(!a||typeof a!="object")throw new Error("Score data must be a valid object");if(!a.studentId||typeof a.studentId!="string")throw new Error("Student ID is required");if(!a.subject||typeof a.subject!="string"||!["math","science","english"].includes(a.subject))throw new Error("Subject must be one of: math, science, english");if(typeof a.score!="number"||a.score<0||a.score>100)throw new Error("Score must be a number between 0 and 100");if(a.type&&!["test","assignment"].includes(a.type))throw new Error("Type must be either test or assignment")},$t=a=>{if(!a||typeof a!="object")throw new Error("Behavior data must be a valid object");if(!a.studentId||typeof a.studentId!="string")throw new Error("Student ID is required");["participation","collaboration","discipline","criticalThinking"].forEach(t=>{if(a[t]!==void 0&&(typeof a[t]!="number"||a[t]<1||a[t]>5))throw new Error(`${t} must be a number between 1 and 5`)})};class qt{async createStudent(s){try{return Ie(s),{id:(await pe(D(A,N.STUDENTS),{...s,createdAt:B(),updatedAt:B()})).id,...s}}catch(t){throw console.error("Error creating student:",t),t}}async getStudents(){try{return(await H(W(D(A,N.STUDENTS),Z("name")))).docs.map(t=>({id:t.id,...t.data()}))}catch(s){throw console.error("Error fetching students:",s),s}}async getStudent(s){try{const t=z(A,N.STUDENTS,s),r=await et(t);if(r.exists())return{id:r.id,...r.data()};throw new Error("Student not found")}catch(t){throw console.error("Error fetching student:",t),t}}async updateStudent(s,t){try{Ie({...t,name:"dummy",class:"dummy"});const r=z(A,N.STUDENTS,s);return await je(r,{...t,updatedAt:B()}),{id:s,...t}}catch(r){throw console.error("Error updating student:",r),r}}async deleteStudent(s){try{const t=Se(A);t.delete(z(A,N.STUDENTS,s));const r=W(D(A,N.SCORES),te("studentId","==",s));(await H(r)).docs.forEach(u=>t.delete(u.ref));const i=W(D(A,N.BEHAVIOR),te("studentId","==",s));return(await H(i)).docs.forEach(u=>t.delete(u.ref)),await t.commit(),s}catch(t){throw console.error("Error deleting student:",t),t}}async addScore(s){try{return Ft(s),{id:(await pe(D(A,N.SCORES),{...s,createdAt:B(),updatedAt:B()})).id,...s}}catch(t){throw console.error("Error adding score:",t),t}}async getScoresByStudent(s){try{const t=W(D(A,N.SCORES),te("studentId","==",s),Z("createdAt","desc"));return(await H(t)).docs.map(n=>({id:n.id,...n.data()}))}catch(t){throw console.error("Error fetching scores:",t),t}}async getScoresBySubject(s){try{const t=W(D(A,N.SCORES),te("subject","==",s),Z("createdAt","desc"));return(await H(t)).docs.map(n=>({id:n.id,...n.data()}))}catch(t){throw console.error("Error fetching scores by subject:",t),t}}async updateScore(s,t){try{const r=z(A,N.SCORES,s);return await je(r,{...t,updatedAt:B()}),{id:s,...t}}catch(r){throw console.error("Error updating score:",r),r}}async deleteScore(s){try{return await Te(z(A,N.SCORES,s)),s}catch(t){throw console.error("Error deleting score:",t),t}}async addBehaviorAssessment(s){try{return $t(s),{id:(await pe(D(A,N.BEHAVIOR),{...s,createdAt:B(),updatedAt:B()})).id,...s}}catch(t){throw console.error("Error adding behavior assessment:",t),t}}async getBehaviorByStudent(s){try{const t=W(D(A,N.BEHAVIOR),te("studentId","==",s),Z("createdAt","desc"));return(await H(t)).docs.map(n=>({id:n.id,...n.data()}))}catch(t){throw console.error("Error fetching behavior assessments:",t),t}}async updateBehaviorAssessment(s,t){try{const r=z(A,N.BEHAVIOR,s);return await je(r,{...t,updatedAt:B()}),{id:s,...t}}catch(r){throw console.error("Error updating behavior assessment:",r),r}}async deleteBehaviorAssessment(s){try{return await Te(z(A,N.BEHAVIOR,s)),s}catch(t){throw console.error("Error deleting behavior assessment:",t),t}}async createAssessment(s){try{return{id:(await pe(D(A,N.ASSESSMENTS),{...s,createdAt:B(),updatedAt:B()})).id,...s}}catch(t){throw console.error("Error creating assessment:",t),t}}async getAssessments(){try{return(await H(W(D(A,N.ASSESSMENTS),Z("createdAt","desc")))).docs.map(t=>({id:t.id,...t.data()}))}catch(s){throw console.error("Error fetching assessments:",s),s}}async getClassAnalytics(){try{const[s,t,r]=await Promise.all([this.getStudents(),H(D(A,N.SCORES)),H(D(A,N.BEHAVIOR))]),n=t.docs.map(g=>({id:g.id,...g.data()})),i=r.docs.map(g=>({id:g.id,...g.data()})),o={},u=["math","science","english"];u.forEach(g=>{const p=n.filter(w=>w.subject===g);if(p.length>0){const w=p.reduce((S,C)=>S+C.score,0)/p.length;o[g]=Math.round(w)}else o[g]=0});const x=Math.round(Object.values(o).reduce((g,p)=>g+p,0)/u.length),f=s.length>0?Math.round(s.reduce((g,p)=>g+(p.attendance||0),0)/s.length):0,d=s.map(g=>{const p=n.filter(S=>S.studentId===g.id),w=p.length>0?p.reduce((S,C)=>S+C.score,0)/p.length:0;return{...g,average:w}}),y=d.reduce((g,p)=>p.average>g.average?p:g,{name:"N/A",average:0}),v=d.reduce((g,p)=>p.average<g.average?p:g,{name:"N/A",average:100});return{subjectAverages:o,overallAverage:x,attendanceAverage:f,topPerformer:y,needsImprovement:v,totalStudents:s.length,totalAssessments:n.length,studentAverages:d}}catch(s){throw console.error("Error calculating class analytics:",s),s}}async getStudentAnalytics(s){try{const[t,r,n]=await Promise.all([this.getStudent(s),this.getScoresByStudent(s),this.getBehaviorByStudent(s)]),i={},o=["math","science","english"];o.forEach(d=>{const y=r.filter(v=>v.subject===d);if(y.length>0){const v=y.reduce((g,p)=>g+p.score,0)/y.length;i[d]=Math.round(v)}else i[d]=0});const u=Math.round(Object.values(i).reduce((d,y)=>d+y,0)/o.length),x=n.length>0?n[0]:null,f=r.sort((d,y)=>new Date(d.createdAt?.toDate?.()||d.createdAt)-new Date(y.createdAt?.toDate?.()||y.createdAt)).map((d,y)=>({name:`Assessment ${y+1}`,[d.subject]:d.score,date:d.createdAt?.toDate?.()||new Date(d.createdAt)}));return{student:t,subjectAverages:i,overallAverage:u,scores:r,behaviors:n,latestBehavior:x,progressData:f}}catch(t){throw console.error("Error calculating student analytics:",t),t}}subscribeToStudents(s){const t=W(D(A,N.STUDENTS),Z("name"));return we(t,r=>{const n=r.docs.map(i=>({id:i.id,...i.data()}));s(n)},r=>{console.error("Error in students subscription:",r)})}subscribeToScores(s){const t=W(D(A,N.SCORES),Z("createdAt","desc"));return we(t,r=>{const n=r.docs.map(i=>({id:i.id,...i.data()}));s(n)},r=>{console.error("Error in scores subscription:",r)})}subscribeToStudentScores(s,t){const r=W(D(A,N.SCORES),te("studentId","==",s),Z("createdAt","desc"));return we(r,n=>{const i=n.docs.map(o=>({id:o.id,...o.data()}));t(i)},n=>{console.error("Error in student scores subscription:",n)})}async migrateDummyData(s){try{const t=Se(A),r={students:0,scores:0,behaviors:0};for(const n of s){const i=z(D(A,N.STUDENTS));t.set(i,{name:n.name,class:n.class,attendance:n.attendance,createdAt:B(),updatedAt:B()}),r.students++;for(const[u,x]of Object.entries(n.subjects))x.scores.forEach((f,d)=>{const y=z(D(A,N.SCORES));t.set(y,{studentId:i.id,subject:u,score:f,type:"test",assessmentName:`Test ${d+1}`,createdAt:B(),updatedAt:B()}),r.scores++}),x.assignments.forEach((f,d)=>{const y=z(D(A,N.SCORES));t.set(y,{studentId:i.id,subject:u,score:f,type:"assignment",assessmentName:`Assignment ${d+1}`,createdAt:B(),updatedAt:B()}),r.scores++});const o=z(D(A,N.BEHAVIOR));t.set(o,{studentId:i.id,participation:n.behavior.participation,collaboration:n.behavior.collaboration,discipline:n.behavior.discipline,criticalThinking:n.behavior.criticalThinking,notes:"Migrated from dummy data",createdAt:B(),updatedAt:B()}),r.behaviors++}return await t.commit(),console.log("Migration completed:",r),r}catch(t){throw console.error("Error migrating dummy data:",t),t}}async clearAllData(){try{const s=Se(A),t=[N.STUDENTS,N.SCORES,N.BEHAVIOR,N.ASSESSMENTS];for(const r of t)(await H(D(A,r))).docs.forEach(i=>s.delete(i.ref));await s.commit(),console.log("All performance data cleared")}catch(s){throw console.error("Error clearing data:",s),s}}}const M=new qt,Ut=[{id:1,name:"Kwame Doku",class:"Basic 5",attendance:95,subjects:{math:{scores:[85,92,78,88],assignments:[90,85]},science:{scores:[92,88,95,90],assignments:[94,89]},english:{scores:[78,85,82,88],assignments:[80,85]}},behavior:{participation:4,collaboration:5,discipline:4,criticalThinking:3}},{id:2,name:"James Aboagye",class:"Basic 5",attendance:88,subjects:{math:{scores:[72,68,75,70],assignments:[65,70]},science:{scores:[85,82,88,84],assignments:[80,82]},english:{scores:[90,92,88,94],assignments:[91,89]}},behavior:{participation:3,collaboration:4,discipline:3,criticalThinking:5}},{id:3,name:"Sophia Anna",class:"Basic 6",attendance:92,subjects:{math:{scores:[95,98,92,96],assignments:[97,94]},science:{scores:[88,92,90,94],assignments:[90,92]},english:{scores:[85,82,88,84],assignments:[86,83]}},behavior:{participation:5,collaboration:4,discipline:5,criticalThinking:4}}],zt=()=>{const[a,s]=j.useState({}),[t,r]=j.useState({}),[n,i]=j.useState({}),[o,u]=j.useState({}),[x,f]=j.useState(null),[d,y]=j.useState(null),[v,g]=j.useState({students:!1,scores:!1,behaviors:!1,analytics:!1,migration:!1}),[p,w]=j.useState(null),{toast:S}=wt(),[C,T]=j.useState([]),m=j.useCallback((c,l)=>{g(h=>({...h,[c]:l}))},[]),b=j.useCallback((c,l)=>{console.error(l,c);let h=l,k="general";c.name==="ValidationError"?(h=`Validation Error: ${c.message}`,k="validation"):c.name==="NetworkError"?(h=`Network Error: ${c.message}. Please check your connection.`,k="network"):c.name==="NotFoundError"?(h=`Not Found: ${c.message}`,k="notFound"):c.message&&(h=c.message),w({message:h,type:k}),S.error(h)},[S]),P=j.useCallback(async()=>{m("students",!0);try{const l=(await M.getStudents()).reduce((k,E)=>(k[E.id]=E,k),{});s(l);const h=Object.values(l);h.length>0&&!d&&y(h[0])}catch(c){b(c,"Failed to load students")}finally{m("students",!1)}},[m,b,d]),U=j.useCallback(async c=>{try{const l=await M.createStudent(c);return s(h=>({...h,[l.id]:l})),S.success("Student added successfully"),l}catch(l){throw b(l,"Failed to add student"),l}},[b,S]),L=j.useCallback(async(c,l)=>{try{const h=await M.updateStudent(c,l);return s(k=>({...k,[c]:{...k[c],...l}})),d?.id===c&&y(k=>({...k,...l})),S.success("Student updated successfully"),h}catch(h){throw b(h,"Failed to update student"),h}},[b,S,d]),G=j.useCallback(async c=>{try{if(await M.deleteStudent(c),s(l=>{const h={...l};return delete h[c],h}),d?.id===c){const l=Object.values(a).filter(h=>h.id!==c);y(l[0]||null)}S.success("Student deleted successfully")}catch(l){throw b(l,"Failed to delete student"),l}},[b,S,d,a]),$=j.useCallback(async c=>{try{const l=await M.addScore(c);return r(h=>({...h,[l.id]:l})),S.success("Score added successfully"),l}catch(l){throw b(l,"Failed to add score"),l}},[b,S]),_=j.useCallback(async(c,l)=>{try{const h=await M.updateScore(c,l);return r(k=>({...k,[c]:{...k[c],...l}})),S.success("Score updated successfully"),h}catch(h){throw b(h,"Failed to update score"),h}},[b,S]),Q=j.useCallback(async c=>{try{await M.deleteScore(c),r(l=>{const h={...l};return delete h[c],h}),S.success("Score deleted successfully")}catch(l){throw b(l,"Failed to delete score"),l}},[b,S]),R=j.useCallback(async c=>{try{const l=await M.addBehaviorAssessment(c);return i(h=>({...h,[l.id]:l})),S.success("Behavior assessment added successfully"),l}catch(l){throw b(l,"Failed to add behavior assessment"),l}},[b,S]),X=j.useCallback(async(c,l)=>{try{const h=await M.updateBehaviorAssessment(c,l);return i(k=>({...k,[c]:{...k[c],...l}})),S.success("Behavior assessment updated successfully"),h}catch(h){throw b(h,"Failed to update behavior assessment"),h}},[b,S]),V=j.useCallback(async c=>{try{await M.deleteBehaviorAssessment(c),i(l=>{const h={...l};return delete h[c],h}),S.success("Behavior assessment deleted successfully")}catch(l){throw b(l,"Failed to delete behavior assessment"),l}},[b,S]),q=j.useCallback(async()=>{m("analytics",!0);try{const c=await M.getClassAnalytics();f(c)}catch(c){b(c,"Failed to load class analytics")}finally{m("analytics",!1)}},[m,b]),Y=j.useCallback(async c=>{m("analytics",!0);try{return await M.getStudentAnalytics(c)}catch(l){return b(l,"Failed to load student analytics"),null}finally{m("analytics",!1)}},[m,b]),ve=j.useCallback(async()=>{m("migration",!0);try{const c=await M.migrateDummyData(Ut);return S.success(`Migration completed: ${c.students} students, ${c.scores} scores, ${c.behaviors} behaviors`),await P(),await q(),c}catch(c){throw b(c,"Failed to migrate dummy data"),c}finally{m("migration",!1)}},[m,b,S,P,q]),he=j.useCallback(()=>{const c=M.subscribeToStudents(l=>{s(l),l.length>0&&!d&&y(l[0])});return T(l=>[...l,c]),c},[d]),me=j.useCallback(()=>{const c=M.subscribeToScores(l=>{r(l)});return T(l=>[...l,c]),c},[]),ze=j.useCallback(c=>{const l=M.subscribeToStudentScores(c,h=>{r(h)});return T(h=>[...h,l]),l},[]),re=j.useCallback(c=>{if(!c||!Object.keys(t).length)return{};const l=Object.values(t).filter(E=>E.studentId===c.id),h={};return["math","science","english"].forEach(E=>{const J=l.filter(be=>be.subject===E);if(J.length>0){const be=J.reduce((Qe,Xe)=>Qe+Xe.score,0)/J.length;h[E]=Math.round(be)}else h[E]=0}),h},[t]),Ke=j.useCallback(c=>{const l=re(c);return["math","science","english"].map(h=>({subject:h.charAt(0).toUpperCase()+h.slice(1),score:l[h]||0,max:100}))},[re]),Ve=j.useCallback(c=>{if(!c||!Object.keys(n).length)return[];const h=Object.values(n).filter(E=>E.studentId===c.id)[0];return h?["participation","collaboration","discipline","criticalThinking"].map(E=>({metric:E.charAt(0).toUpperCase()+E.slice(1).replace(/([A-Z])/g," $1").trim(),score:h[E]||0,max:5})):[]},[n]),He=j.useCallback(c=>{if(!c||!Object.keys(t).length)return[];const l=Object.values(t).filter(k=>k.studentId===c.id).sort((k,E)=>new Date(k.createdAt?.toDate?.()||k.createdAt)-new Date(E.createdAt?.toDate?.()||E.createdAt)),h=new Map;return l.forEach((k,E)=>{const J=`Assessment ${E+1}`;h.has(J)||h.set(J,{name:J}),h.get(J)[k.subject]=k.score}),Array.from(h.values())},[t]),We=j.useCallback(()=>x?x.subjectAverages||{}:{},[x]),Ge=j.useCallback(()=>!Object.keys(a).length||!Object.keys(t).length?[]:Object.values(a).map(c=>{const l=re(c),h=Object.values(l).length>0?Math.round(Object.values(l).reduce((k,E)=>k+E,0)/Object.values(l).length):0;return{name:c.name.split(" ")[0],average:h}}),[a,t,re]);return j.useEffect(()=>{P(),q();const c=he(),l=me();return()=>{C.forEach(h=>{typeof h=="function"&&h()}),c(),l()}},[]),j.useEffect(()=>()=>{C.forEach(c=>{typeof c=="function"&&c()})},[C]),{students:Object.values(a),scores:Object.values(t),behaviors:Object.values(n),assessments:Object.values(o),analytics:x,selectedStudent:d,loading:v,error:p,addStudent:U,updateStudent:L,deleteStudent:G,setSelectedStudent:y,addScore:$,updateScore:_,deleteScore:Q,addBehavior:R,updateBehavior:X,deleteBehavior:V,loadClassAnalytics:q,loadStudentAnalytics:Y,migrateDummyData:ve,subscribeToStudents:he,subscribeToScores:me,subscribeToStudentScores:ze,calculateAverages:re,getAcademicData:Ke,getBehaviorData:Ve,getProgressData:He,getClassAverages:We,getStudentComparison:Ge,loadStudents:P,clearError:()=>w(null)}},Kt=({currentView:a,selectedStudent:s,students:t,onBackToDashboard:r,onDataInputView:n,onMigrateData:i})=>e.jsx("div",{className:"bg-white shadow-sm border-b",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex items-center justify-between h-16",children:[e.jsxs("div",{className:"flex items-center",children:[a!=="dashboard"&&e.jsxs(O,{onClick:r,variant:"ghost",className:"mr-4",children:[e.jsx(bt,{className:"h-4 w-4 mr-2"}),"Back"]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(Je,{className:"h-6 w-6 text-blue-600 mr-3"}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-xl font-semibold text-gray-900",children:[a==="dashboard"&&"Performance Dashboard",a==="student"&&`${s?.name} - Performance Details`,a==="input"&&"Data Input"]}),e.jsxs("p",{className:"text-sm text-gray-500",children:[a==="dashboard"&&"Monitor and analyze student performance",a==="student"&&"Academic scores and behavioral assessments",a==="input"&&"Add scores and behavioral data"]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[a==="dashboard"&&e.jsxs(e.Fragment,{children:[e.jsxs(O,{onClick:n,variant:"outline",className:"hidden sm:flex",children:[e.jsx(St,{className:"h-4 w-4 mr-2"}),"Add Data"]}),e.jsxs(O,{onClick:i,variant:"outline",className:"hidden sm:flex",children:[e.jsx(tt,{className:"h-4 w-4 mr-2"}),"Sample Data"]})]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[e.jsx(Ze,{className:"h-4 w-4 mr-1"}),t.length," Students"]})]})]})})}),Vt=["math","science","english"],Ht=({analytics:a,classAverages:s,studentComparison:t,onMigrateData:r,onStudentSelect:n,onDataInputClick:i})=>e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-700",children:"Class Performance Overview"}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx(O,{onClick:i,variant:"primary",size:"sm",children:"Add Data"}),e.jsx(O,{onClick:r,variant:"outline",size:"sm",children:"Sample Data"})]})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:[{title:"Class Average",value:a?`${a.overallAverage}%`:"0%"},{title:"Top Performer",value:a?.topPerformer?.name?.split(" ")[0]||"N/A",subValue:a?`${Math.round(a.topPerformer.average)}%`:"0%"},{title:"Attendance Rate",value:a?`${a.attendanceAverage}%`:"0%"},{title:"Total Students",value:a?.totalStudents||0}].map(o=>e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg transition-transform transform hover:-translate-y-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-600",children:o.title}),e.jsx("p",{className:"text-3xl font-bold text-indigo-600 mt-2",children:o.value}),o.subValue&&e.jsx("p",{className:"text-xl font-semibold text-gray-500",children:o.subValue})]},o.title))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"bg-white p-4 sm:p-6 rounded-xl shadow-lg",children:[e.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Subject Averages"}),e.jsx(ie,{width:"100%",height:300,children:e.jsxs(Ce,{data:Vt.map(o=>({subject:o.charAt(0).toUpperCase()+o.slice(1),average:s[o]||0})),children:[e.jsx(xe,{strokeDasharray:"3 3"}),e.jsx(de,{dataKey:"subject"}),e.jsx(ue,{}),e.jsx(ce,{}),e.jsx(Ee,{dataKey:"average",fill:"#4f46e5"})]})})]}),e.jsxs("div",{className:"bg-white p-4 sm:p-6 rounded-xl shadow-lg",children:[e.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Student Comparison"}),e.jsx(ie,{width:"100%",height:300,children:e.jsxs(Ce,{data:t,children:[e.jsx(xe,{strokeDasharray:"3 3"}),e.jsx(de,{dataKey:"name"}),e.jsx(ue,{}),e.jsx(ce,{cursor:{fill:"rgba(59, 130, 246, 0.1)"},content:({active:o,payload:u,label:x})=>o&&u&&u.length?e.jsxs("div",{className:"bg-white p-3 border rounded-lg shadow-lg",children:[e.jsx("p",{className:"font-semibold",children:x}),e.jsxs("p",{className:"text-blue-600",children:["Average: ",u[0].value,"%"]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Click to view details"})]}):null}),e.jsx(Ee,{dataKey:"average",fill:"#10b981",onClick:o=>{if(o&&n){const u=t.find(x=>x.name===o.name);u&&u.fullStudent&&n(u.fullStudent)}},style:{cursor:"pointer"}})]})})]})]})]}),_e=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884D8"],Wt=({students:a,selectedStudent:s,onStudentSelect:t,getAcademicData:r,getBehaviorData:n,getProgressData:i})=>{const[o,u]=j.useState("academic"),x=({targetTab:f,children:d})=>e.jsx("button",{className:`py-2 px-4 font-medium transition-colors duration-200 ${o===f?"border-b-2 border-indigo-600 text-indigo-600":"text-gray-500 hover:text-gray-700"}`,onClick:()=>u(f),children:d});return s?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center bg-white p-4 rounded-xl shadow-lg",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-700",children:"Student Details"}),e.jsx("select",{className:"mt-2 md:mt-0 w-full md:w-auto p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",value:s.id,onChange:f=>t(a.find(d=>d.id===f.target.value)),children:a.map(f=>e.jsxs("option",{value:f.id,children:[f.name," - ",f.class]},f.id))})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg",children:[e.jsx("h3",{className:"text-2xl font-bold",children:s.name}),e.jsxs("p",{className:"text-gray-600",children:["Class: ",s.class]}),e.jsxs("p",{className:"text-gray-600",children:["Attendance: ",s.attendance,"%"]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-4 sm:p-6",children:[e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("nav",{className:"-mb-px flex space-x-6","aria-label":"Tabs",children:[e.jsx(x,{targetTab:"academic",children:"Academic Performance"}),e.jsx(x,{targetTab:"behavioral",children:"Behavioral Metrics"})]})}),e.jsxs("div",{className:"mt-6",children:[o==="academic"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-xl font-semibold mb-4 text-center",children:"Subject Scores"}),e.jsx(ie,{width:"100%",height:300,children:e.jsxs(Ce,{data:r(s),children:[e.jsx(xe,{strokeDasharray:"3 3"}),e.jsx(de,{dataKey:"subject"}),e.jsx(ue,{}),e.jsx(ce,{}),e.jsx(Ee,{dataKey:"score",fill:"#4f46e5"})]})})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-xl font-semibold mb-4 text-center",children:"Progress Over Time"}),e.jsx(ie,{width:"100%",height:300,children:e.jsxs(_t,{data:i(s),children:[e.jsx(xe,{strokeDasharray:"3 3"}),e.jsx(de,{dataKey:"name"}),e.jsx(ue,{}),e.jsx(ce,{}),e.jsx(ft,{}),e.jsx(ee,{type:"monotone",dataKey:"math",stroke:"#8884d8"}),e.jsx(ee,{type:"monotone",dataKey:"science",stroke:"#82ca9d"}),e.jsx(ee,{type:"monotone",dataKey:"english",stroke:"#ffc658"})]})})]})]}),o==="behavioral"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 items-center",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-xl font-semibold mb-4 text-center",children:"Behavioral Assessment"}),e.jsx(ie,{width:"100%",height:300,children:e.jsxs(gt,{children:[e.jsx(xt,{data:n(s),cx:"50%",cy:"50%",labelLine:!1,outerRadius:100,fill:"#8884d8",dataKey:"score",label:({metric:f,score:d})=>`${f.split(" ")[0]}: ${d}`,children:n(s).map((f,d)=>e.jsx(yt,{fill:_e[d%_e.length]},`cell-${d}`))}),e.jsx(ce,{})]})})]}),e.jsxs("div",{className:"bg-gray-50 p-6 rounded-lg",children:[e.jsx("h4",{className:"text-xl font-semibold mb-4",children:"Detailed Ratings (1-5 scale)"}),e.jsx("ul",{className:"space-y-3 text-gray-700",children:n(s).map(f=>e.jsxs("li",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"font-medium",children:[f.metric,":"]}),e.jsx("span",{className:"font-bold text-lg text-indigo-600 bg-indigo-100 rounded-full px-3 py-1",children:f.score})]},f.metric))})]})]})]})]})]}):e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-600",children:"No student selected"})})},Gt=["math","science","english"],Qt=["participation","collaboration","discipline","criticalThinking"],Xt=({students:a,onAddStudent:s,onAddScore:t,onAddBehavior:r})=>{const[n,i]=j.useState(!1),[o,u]=j.useState(!1),[x,f]=j.useState(!1),[d,y]=j.useState({name:"",class:"",attendance:""}),[v,g]=j.useState({studentId:"",subject:"math",score:"",type:"test",assessmentName:""}),[p,w]=j.useState({studentId:"",participation:3,collaboration:3,discipline:3,criticalThinking:3,notes:""}),S=async m=>{m.preventDefault();try{await s({name:d.name,class:d.class,attendance:d.attendance?parseInt(d.attendance):void 0}),i(!1),y({name:"",class:"",attendance:""})}catch(b){console.error("Failed to add student:",b)}},C=async m=>{m.preventDefault();try{await t({studentId:v.studentId,subject:v.subject,score:parseInt(v.score),type:v.type,assessmentName:v.assessmentName||`${v.type} Assessment`}),u(!1),g({studentId:"",subject:"math",score:"",type:"test",assessmentName:""})}catch(b){console.error("Failed to add score:",b)}},T=async m=>{m.preventDefault();try{await r({studentId:p.studentId,participation:parseInt(p.participation),collaboration:parseInt(p.collaboration),discipline:parseInt(p.discipline),criticalThinking:parseInt(p.criticalThinking),notes:p.notes}),f(!1),w({studentId:"",participation:3,collaboration:3,discipline:3,criticalThinking:3,notes:""})}catch(b){console.error("Failed to add behavior assessment:",b)}};return e.jsxs("div",{className:"max-w-2xl mx-auto space-y-6",children:[e.jsxs("div",{className:"bg-white p-8 rounded-xl shadow-lg",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-700 mb-6",children:"Input Student Data"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsx(O,{onClick:()=>i(!0),variant:"primary",className:"w-full",children:"Add Student"}),e.jsx(O,{onClick:()=>u(!0),variant:"outline",className:"w-full",children:"Add Academic Score"}),e.jsx(O,{onClick:()=>f(!0),variant:"secondary",className:"w-full",children:"Add Behavior Assessment"})]}),e.jsx("div",{className:"text-center text-gray-600",children:e.jsx("p",{children:"Use the buttons above to add students, academic scores, or behavioral assessments."})})]}),e.jsx(ge,{isOpen:n,onClose:()=>i(!1),title:"Add Student",children:e.jsxs("form",{onSubmit:S,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Student Name"}),e.jsx(ne,{type:"text",value:d.name,onChange:m=>y({...d,name:m.target.value}),placeholder:"Enter student name",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Class"}),e.jsx(ne,{type:"text",value:d.class,onChange:m=>y({...d,class:m.target.value}),placeholder:"e.g., Basic 5, JHS 1",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Attendance Rate (Optional)"}),e.jsx(ne,{type:"number",min:"0",max:"100",value:d.attendance,onChange:m=>y({...d,attendance:m.target.value}),placeholder:"e.g., 95"})]}),e.jsxs("div",{className:"flex justify-end space-x-4 pt-4",children:[e.jsx(O,{type:"button",onClick:()=>i(!1),variant:"outline",children:"Cancel"}),e.jsx(O,{type:"submit",variant:"primary",children:"Add Student"})]})]})}),e.jsx(ge,{isOpen:o,onClose:()=>u(!1),title:"Add Academic Score",children:e.jsxs("form",{onSubmit:C,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Student"}),e.jsxs("select",{value:v.studentId,onChange:m=>g({...v,studentId:m.target.value}),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500",required:!0,children:[e.jsx("option",{value:"",children:"Select a student"}),a.map(m=>e.jsx("option",{value:m.id,children:m.name},m.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject"}),e.jsx("select",{value:v.subject,onChange:m=>g({...v,subject:m.target.value}),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500",children:Gt.map(m=>e.jsx("option",{value:m,children:m.charAt(0).toUpperCase()+m.slice(1)},m))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Assessment Type"}),e.jsxs("select",{value:v.type,onChange:m=>g({...v,type:m.target.value}),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500",children:[e.jsx("option",{value:"test",children:"Test"}),e.jsx("option",{value:"assignment",children:"Assignment"}),e.jsx("option",{value:"quiz",children:"Quiz"}),e.jsx("option",{value:"project",children:"Project"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Score (0-100)"}),e.jsx(ne,{type:"number",min:"0",max:"100",value:v.score,onChange:m=>g({...v,score:m.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Assessment Name (Optional)"}),e.jsx(ne,{type:"text",value:v.assessmentName,onChange:m=>g({...v,assessmentName:m.target.value}),placeholder:"e.g., Midterm Exam, Chapter 5 Quiz"})]}),e.jsxs("div",{className:"flex justify-end space-x-4 pt-4",children:[e.jsx(O,{type:"button",onClick:()=>u(!1),variant:"outline",children:"Cancel"}),e.jsx(O,{type:"submit",variant:"primary",children:"Add Score"})]})]})}),e.jsx(ge,{isOpen:x,onClose:()=>f(!1),title:"Add Behavior Assessment",children:e.jsxs("form",{onSubmit:T,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Student"}),e.jsxs("select",{value:p.studentId,onChange:m=>w({...p,studentId:m.target.value}),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500",required:!0,children:[e.jsx("option",{value:"",children:"Select a student"}),a.map(m=>e.jsx("option",{value:m.id,children:m.name},m.id))]})]}),Qt.map(m=>e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[m.charAt(0).toUpperCase()+m.slice(1).replace(/([A-Z])/g," $1").trim()," (1-5)"]}),e.jsx("select",{value:p[m],onChange:b=>w({...p,[m]:b.target.value}),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500",children:[1,2,3,4,5].map(b=>e.jsx("option",{value:b,children:b},b))})]},m)),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes (Optional)"}),e.jsx("textarea",{value:p.notes,onChange:m=>w({...p,notes:m.target.value}),rows:"3",className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500",placeholder:"Additional observations or comments..."})]}),e.jsxs("div",{className:"flex justify-end space-x-4 pt-4",children:[e.jsx(O,{type:"button",onClick:()=>f(!1),variant:"outline",children:"Cancel"}),e.jsx(O,{type:"submit",variant:"primary",children:"Add Assessment"})]})]})})]})},Yt=({currentView:a,selectedStudent:s,students:t,scores:r,behaviors:n,loading:i,error:o,onStudentSelect:u,onDataInputClick:x,getClassAnalytics:f,getStudentScores:d,getStudentBehaviors:y,getStudentAnalytics:v,addStudent:g,updateStudent:p,deleteStudent:w,addScore:S,updateScore:C,deleteScore:T,addBehavior:m,updateBehavior:b,deleteBehavior:P,clearAllData:U,onMigrateData:L})=>(()=>{if(i&&t.length===0)return e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs(Ae,{className:"p-8 text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 mb-2",children:"Loading performance data..."}),e.jsx("p",{className:"text-sm text-gray-500",children:"This may take a few moments"})]})});if(o)return e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs(Ae,{className:"p-8 text-center border-red-200 bg-red-50",children:[e.jsxs("div",{className:"text-red-500 mb-4",children:[e.jsx("svg",{className:"w-12 h-12 mx-auto mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"})}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Error Loading Performance Data"}),e.jsx("p",{className:"text-red-600 mb-4",children:o})]}),e.jsxs("div",{className:"flex justify-center space-x-3",children:[e.jsx(O,{onClick:()=>window.location.reload(),variant:"outline",children:"Retry"}),e.jsx(O,{onClick:L,variant:"primary",children:"Load Sample Data"})]})]})});if(t.length===0)return e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs(Ae,{className:"p-8 text-center",children:[e.jsx("div",{className:"text-gray-400 mb-4",children:e.jsx("svg",{className:"w-16 h-16 mx-auto mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),e.jsx("h2",{className:"text-xl font-bold text-gray-700 mb-4",children:"No Performance Data Found"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"It looks like you don't have any student performance data yet. Get started by adding students and their academic scores, or load sample data to explore the features."}),e.jsxs("div",{className:"flex justify-center space-x-3",children:[e.jsx(O,{onClick:x,variant:"primary",children:"Add Students"}),e.jsx(O,{onClick:L,variant:"outline",children:"Load Sample Data"})]})]})});switch(a){case"dashboard":const $=f();return e.jsx(Ht,{analytics:$,classAverages:$?.subjectAverages||{},studentComparison:t.map(_=>({name:_.name.split(" ")[0],average:v(_.id)?.overallAverage||0,fullStudent:_})),onMigrateData:L,onStudentSelect:u,onDataInputClick:x});case"student":return e.jsx(Wt,{student:s,scores:d(s?.id),behaviors:y(s?.id),analytics:v(s?.id)});case"input":return e.jsx(Xt,{students:t,onAddStudent:g,onUpdateStudent:p,onDeleteStudent:w,onAddScore:S,onUpdateScore:C,onDeleteScore:T,onAddBehavior:m,onUpdateBehavior:b,onDeleteBehavior:P,onClearAllData:U});default:return null}})(),Jt=({isOpen:a,onClose:s,onMigrate:t,loading:r})=>e.jsx(ge,{isOpen:a,onClose:s,title:"Migrate Sample Data",children:e.jsxs("div",{className:"p-6",children:[e.jsx("p",{className:"text-gray-600 mb-6",children:"This will add sample student data including academic scores and behavioral assessments. This action cannot be undone."}),e.jsxs("div",{className:"flex justify-end space-x-4",children:[e.jsx(O,{onClick:s,variant:"outline",children:"Cancel"}),e.jsx(O,{onClick:t,variant:"primary",disabled:r,children:r?"Migrating...":"Migrate Data"})]})]})}),is=()=>{const[a,s]=j.useState("dashboard"),[t,r]=j.useState(null),[n,i]=j.useState(!1),{students:o,scores:u,behaviors:x,loading:f,error:d,addStudent:y,updateStudent:v,deleteStudent:g,addScore:p,updateScore:w,deleteScore:S,addBehavior:C,updateBehavior:T,deleteBehavior:m,migrateData:b,clearAllData:P,getStudentScores:U,getStudentBehaviors:L,getClassAnalytics:G,getStudentAnalytics:$}=zt(),_=async()=>{await b(),i(!1)},Q=q=>{r(q),s("student")},R=()=>{s("dashboard"),r(null)},X=()=>{s("input")},V=()=>{i(!0)};return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Kt,{currentView:a,selectedStudent:t,students:o,onBackToDashboard:R,onDataInputView:X,onMigrateData:V}),e.jsx(Yt,{currentView:a,selectedStudent:t,students:o,scores:u,behaviors:x,loading:f,error:d,onStudentSelect:Q,onDataInputClick:X,getClassAnalytics:G,getStudentScores:U,getStudentBehaviors:L,getStudentAnalytics:$,addStudent:y,updateStudent:v,deleteStudent:g,addScore:p,updateScore:w,deleteScore:S,addBehavior:C,updateBehavior:T,deleteBehavior:m,clearAllData:P,onMigrateData:V}),e.jsx(Jt,{isOpen:n,onClose:()=>i(!1),onMigrate:_,loading:f})]})};export{is as default};
